<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Hundred Acre Celebration: Welcoming Baby Gunner</title>

    <!-- Fonts & Icons -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">

    <style>
    :root {
        --pooh-yellow: #FFC42B;
        --pooh-red: #D62E2E;
        --honey-gold: #E6B86A;
        --soft-blue: #B0D0E3;
        --sage-green: #9CAD90;
        --cream: #FFF7EC;
        --text-dark: #43302a;
        --storybook-brown: #8B4513;
        --page-yellow: #FEF9E7;
        --deep-ink: #2f1a0e;
        --shadow-soft: 0 20px 60px rgba(15, 23, 42, 0.16);
        --radius-lg: 24px;
        --radius-pill: 999px;
        --transition-smooth: all 0.5s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        --font-heading: 'Playfair Display', serif;
        --font-body: 'Lato', system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
    }

    *, *::before, *::after {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    html {
        scroll-behavior: smooth;
        scroll-padding-top: 100px;
    }

    body {
        font-family: var(--font-body);
        background:
            radial-gradient(circle at top, #FFFDF6 0%, #F7EAD5 40%, #E2D1B5 80%),
            linear-gradient(180deg, #f4ebdd 0%, #e2cfb5 60%, #d6c2a8 100%);
        color: var(--text-dark);
        -webkit-font-smoothing: antialiased;
        line-height: 1.7;
        overflow-x: hidden;
    }

    /* Reduced motion */
    body.reduce-motion,
    body.reduce-motion * {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition: none !important;
        scroll-behavior: auto !important;
    }

    /* Accessibility */
    .skip-link {
        position: absolute;
        top: -100px;
        left: 16px;
        background: #fff;
        color: var(--storybook-brown);
        padding: 10px 14px;
        border-radius: 12px;
        box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
        transition: top 0.3s ease;
        z-index: 1100;
        font-weight: 700;
    }

    .skip-link:focus-visible {
        top: 16px;
        outline: 3px solid var(--pooh-red);
        outline-offset: 4px;
    }

    :focus-visible {
        outline: 3px solid var(--pooh-red);
        outline-offset: 4px;
        box-shadow: 0 0 0 4px rgba(255, 196, 43, 0.45);
    }

    .sr-only {
        position: absolute;
        width: 1px;
        height: 1px;
        padding: 0;
        margin: -1px;
        overflow: hidden;
        clip: rect(0, 0, 0, 0);
        white-space: nowrap;
        border: 0;
    }

    /* Loading screen */
    .loading-screen {
        position: fixed;
        inset: 0;
        background: radial-gradient(circle at top, #FFEAA7 0, #FBBF24 35%, #D97706 70%, #7C2D12 100%);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 10002;
        transition: opacity 0.6s ease, visibility 0.6s ease;
    }

    .loading-screen.hidden {
        opacity: 0;
        visibility: hidden;
    }

    .honey-spinner {
        width: 120px;
        height: 120px;
        position: relative;
        margin-bottom: 25px;
    }

    .loading-jar {
        width: 80px;
        height: 96px;
        background: var(--honey-gold);
        border-radius: 16px 16px 10px 10px;
        position: relative;
        overflow: hidden;
        margin: 0 auto;
        box-shadow: 0 8px 20px rgba(0,0,0,0.25);
        border: 3px solid #FFF7EC;
    }

    .loading-honey-fill {
        position: absolute;
        bottom: 0;
        left: 0;
        width: 100%;
        height: 0%;
        background: linear-gradient(to top, #FFC42B, #FACC15);
        animation: fill-honey 2s ease-in-out infinite;
    }

    @keyframes fill-honey {
        0%, 100% { height: 25%; }
        50% { height: 92%; }
    }

    .loading-text {
        font-family: var(--font-heading);
        font-size: 2.2rem;
        color: #FFF;
        text-align: center;
        text-shadow: 0 3px 18px rgba(0,0,0,0.4);
        margin-bottom: 8px;
        letter-spacing: 0.04em;
    }

    .loading-subtext {
        font-size: 1rem;
        color: #FFF;
        text-align: center;
        opacity: 0.9;
        max-width: 480px;
        line-height: 1.6;
    }

    .loading-dots {
        display: flex;
        gap: 10px;
        margin-top: 16px;
    }

    .loading-dot {
        width: 10px;
        height: 10px;
        border-radius: 50%;
        background: white;
        animation: dot-bounce 1.3s ease-in-out infinite both;
    }

    .loading-dot:nth-child(1) { animation-delay: -0.28s; }
    .loading-dot:nth-child(2) { animation-delay: -0.14s; }

    @keyframes dot-bounce {
        0%, 80%, 100% { transform: scale(0); }
        40% { transform: scale(1); }
    }

    .loading-hint {
        margin-top: 18px;
        font-size: 0.9rem;
        color: rgba(255,255,255,0.9);
    }

    /* Nav */
    .main-nav {
        position: sticky;
        top: 0;
        z-index: 1000;
        background: rgba(255, 250, 241, 0.96);
        backdrop-filter: blur(12px);
        border-bottom: 1px solid rgba(139, 69, 19, 0.14);
        box-shadow: 0 8px 24px rgba(15, 23, 42, 0.12);
        border-radius: 0 0 18px 18px;
        transition: all 0.3s ease;
    }

    .nav-container {
        max-width: 1240px;
        margin: 0 auto;
        padding: 10px 18px;
        display: flex;
        justify-content: space-between;
        align-items: center;
    }

    .nav-brand {
        display: flex;
        flex-direction: column;
        gap: 2px;
        transition: all 0.3s ease;
    }

    .nav-title {
        font-family: var(--font-heading);
        font-size: 1.6rem;
        color: var(--storybook-brown);
        text-decoration: none;
        letter-spacing: 0.03em;
        transition: all 0.3s ease;
    }

    .nav-subtitle {
        font-family: var(--font-heading);
        font-style: italic;
        font-size: 1.05rem;
        color: var(--pooh-red);
        transition: all 0.3s ease;
    }

    .nav-menu {
        display: flex;
        gap: 6px;
        align-items: center;
    }

    .nav-item {
        display: inline-flex;
        align-items: center;
        gap: 6px;
        padding: 8px 14px;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 999px;
        text-decoration: none;
        color: var(--storybook-brown);
        font-weight: 700;
        transition: all 0.22s ease;
        border: 1px solid rgba(148, 81, 35, 0.14);
        box-shadow: 0 2px 6px rgba(0,0,0,0.06);
        font-size: 0.9rem;
        white-space: nowrap;
        position: relative;
        overflow: hidden;
    }

    .nav-item::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
        transition: left 0.5s ease;
    }

    .nav-item:hover::before {
        left: 100%;
    }

    .nav-item i {
        font-size: 0.95rem;
        transition: transform 0.3s ease;
    }

    .nav-item:hover i {
        transform: scale(1.1);
    }

    .nav-item:hover,
    .nav-item.active {
        background: linear-gradient(135deg, #fdf2cc, #f3d28a);
        color: #5b3a1b;
        border-color: rgba(139, 69, 19, 0.28);
        box-shadow: 0 8px 18px rgba(149, 92, 24, 0.22);
        transform: translateY(-1px);
    }

    .nav-toggle {
        display: none;
        background: var(--pooh-yellow);
        border: 2px solid var(--storybook-brown);
        border-radius: 12px;
        width: 44px;
        height: 44px;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        transition: all 0.25s ease;
        position: relative;
        overflow: hidden;
    }

    .nav-toggle::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(circle at center, rgba(255,255,255,0.3) 0%, transparent 70%);
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .nav-toggle:hover::before {
        opacity: 1;
    }

    .nav-toggle:hover {
        background: var(--pooh-red);
        transform: scale(1.06);
    }

    .nav-toggle i {
        color: white;
        font-size: 1.3rem;
        transition: transform 0.3s ease;
    }

    .nav-toggle:hover i {
        transform: rotate(90deg);
    }

    /* Storybook cover */
    .storybook-cover {
        position: fixed;
        inset: 0;
        background: radial-gradient(circle at top, #fff8e8 0%, #f4d9a6 45%, #e4b96f 100%);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 10001;
        transition: transform 1.1s cubic-bezier(0.77, 0, 0.175, 1), opacity 0.8s ease;
        transform-style: preserve-3d;
        box-shadow: 0 18px 90px rgba(0,0,0,0.25);
        overflow: hidden;
        padding: 20px;
    }

    .storybook-cover.closed {
        transform: rotateY(88deg) scale(0.78);
        opacity: 0;
        pointer-events: none;
    }

    .cover-decoration {
        position: absolute;
        inset: 8%;
        border-radius: 26px;
        border: 2px solid rgba(255,255,255,0.65);
        box-shadow:
            inset 0 0 0 1px rgba(0,0,0,0.08),
            0 0 60px rgba(0,0,0,0.2);
        background: radial-gradient(circle at center, rgba(255,255,255,0.14) 0, transparent 60%);
    }

    .cover-title {
        font-family: var(--font-heading);
        font-size: clamp(2.8rem, 6vw, 4.4rem);
        color: #4a2f1e;
        text-align: center;
        margin-bottom: 0.5rem;
        text-shadow: 0 7px 28px rgba(0,0,0,0.22);
        position: relative;
        z-index: 2;
        line-height: 1.08;
        letter-spacing: 0.05em;
        text-transform: uppercase;
    }

    .cover-subtitle {
        font-family: var(--font-heading);
        font-style: italic;
        font-size: clamp(1.9rem, 3.6vw, 2.7rem);
        color: #6f492d;
        text-align: center;
        margin-bottom: 2.1rem;
        opacity: 0.95;
        position: relative;
        z-index: 2;
    }

    .open-book-btn {
        padding: 13px 34px;
        font-size: 1.1rem;
        background: linear-gradient(135deg, #fef6e4, #f3dfb2);
        color: #6a3d24;
        border: none;
        border-radius: 999px;
        cursor: pointer;
        font-weight: 700;
        box-shadow: 0 10px 26px rgba(0,0,0,0.25);
        transition: all 0.3s ease;
        font-family: var(--font-heading);
        position: relative;
        z-index: 2;
        overflow: hidden;
        letter-spacing: 0.09em;
        text-transform: uppercase;
    }

    .open-book-btn::after {
        content: '';
        position: absolute;
        inset: 0;
        background: radial-gradient(circle at top left, rgba(255,255,255,0.7), transparent 55%);
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .open-book-btn:hover {
        transform: translateY(-2px) scale(1.02);
        box-shadow: 0 14px 32px rgba(0,0,0,0.3);
    }

    .open-book-btn:hover::after {
        opacity: 1;
    }

    /* Background */
    .honeycomb-bg {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background-image:
            radial-gradient(circle at 25% 25%, rgba(255, 196, 43, 0.06) 0%, transparent 55%),
            radial-gradient(circle at 75% 75%, rgba(230, 184, 106, 0.08) 0%, transparent 55%),
            url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="120" height="120"><path d="M60,0 L90,30 L90,90 L60,120 L30,90 L30,30 Z" fill="%23E6B86A" opacity="0.04"/></svg>');
        background-size: auto, auto, 120px;
        z-index: -3;
        pointer-events: none;
    }

    .golden-light {
        position: fixed;
        inset: 0;
        background: radial-gradient(ellipse at center, rgba(255, 215, 0, 0.18) 0%, rgba(255, 215, 0, 0) 70%);
        z-index: -1;
        animation: light-pulse 16s ease-in-out infinite;
        pointer-events: none;
    }

    @keyframes light-pulse {
        0%, 100% { opacity: 0.12; }
        50% { opacity: 0.26; }
    }

    .enchanted-forest {
        position: fixed;
        inset: 0;
        z-index: -2;
        overflow: hidden;
        opacity: 0.33;
        pointer-events: none;
    }

    .tree {
        position: absolute;
        bottom: -40px;
        width: 180px;
        height: 220px;
        background: linear-gradient(to right, #8B5A2B, #A0522D);
        border-radius: 20px 20px 0 0;
        transform-origin: bottom;
        box-shadow: 0 0 18px rgba(0,0,0,0.25);
    }

    .floating-leaf {
        position: absolute;
        width: 40px;
        height: 40px;
        background: radial-gradient(ellipse at center, #BBF7D0, #22C55E);
        border-radius: 50% 0 50% 50%;
        transform: rotate(45deg);
        animation: leaf-fall 15s linear infinite;
        opacity: 0.7;
        filter: drop-shadow(0 5px 5px rgba(0,0,0,0.18));
    }

    @keyframes leaf-fall {
        0% {
            transform: translateY(-100vh) rotate(0deg);
            opacity: 0;
        }
        10% { opacity: 0.9; }
        90% { opacity: 0.7; }
        100% {
            transform: translateY(100vh) rotate(360deg);
            opacity: 0;
        }
    }

    /* Main content shell */
    .storybook-shell {
        max-width: 1180px;
        margin: 0 auto;
        padding: 40px 20px 60px;
    }

    .storybook {
        position: relative;
        width: 100%;
        opacity: 0;
        transition: opacity 1.2s ease;
        background: rgba(255, 252, 244, 0.98);
        border-radius: 28px;
        box-shadow: var(--shadow-soft);
        padding: 34px 32px 40px;
        border: 1px solid rgba(148, 81, 35, 0.22);
        overflow: hidden;
    }

    .storybook::before {
        content: '';
        position: absolute;
        inset: 16px;
        background-image: linear-gradient(
            90deg,
            rgba(255,255,255,0.5) 0,
            rgba(230, 215, 190, 0.45) 50%,
            rgba(255,255,255,0.5) 100%
        );
        opacity: 0.12;
        pointer-events: none;
        mix-blend-mode: multiply;
    }

    .storybook::after {
        content: '';
        position: absolute;
        top: 16px;
        bottom: 16px;
        left: 50%;
        width: 2px;
        background: linear-gradient(
            to bottom,
            rgba(160, 120, 80, 0.0),
            rgba(160, 120, 80, 0.33),
            rgba(160, 120, 80, 0.0)
        );
        opacity: 0.7;
    }

    .storybook.visible {
        opacity: 1;
    }

    .storybook-inner {
        max-width: 880px;
        margin: 0 auto;
        position: relative;
        z-index: 1;
    }

    .storybook-header {
        text-align: center;
        margin-bottom: 18px;
    }

    .storybook-heading {
        font-family: var(--font-heading);
        font-size: 2.35rem;
        color: var(--storybook-brown);
        margin-bottom: 4px;
        letter-spacing: 0.03em;
    }

    .storybook-subheading {
        font-family: var(--font-heading);
        font-style: italic;
        font-size: 1.5rem;
        color: var(--pooh-red);
    }

    /* Sections */
    .content-section {
        background: var(--page-yellow);
        width: 100%;
        margin: 30px 0;
        border-radius: 22px;
        box-shadow: 0 10px 30px rgba(15, 23, 42, 0.14);
        position: relative;
        overflow: hidden;
        padding: 26px 24px 30px;
        transform-style: preserve-3d;
        transition: opacity 0.6s ease, transform 0.6s ease, box-shadow 0.25s ease;
        opacity: 0;
        transform: translateY(32px);
        border: 1px solid rgba(148, 81, 35, 0.18);
    }

    .content-section.visible {
        opacity: 1;
        transform: translateY(0);
    }

    .content-section:hover {
        box-shadow: 0 14px 40px rgba(15, 23, 42, 0.18);
    }

    .content-section::before {
        content: '';
        position: absolute;
        inset: 0;
        background-image:
            radial-gradient(circle at 5% 5%, rgba(252, 211, 77, 0.15) 0, transparent 45%),
            radial-gradient(circle at 95% 95%, rgba(252, 211, 77, 0.12) 0, transparent 45%);
        opacity: 0.8;
        pointer-events: none;
    }

    .content-section-inner {
        position: relative;
        z-index: 1;
    }

    .section-number {
        position: absolute;
        top: 16px;
        right: 22px;
        font-family: var(--font-heading);
        font-size: 1.4rem;
        color: rgba(67, 48, 42, 0.6);
    }

    .section-header {
        text-align: center;
        margin-bottom: 18px;
    }

    .story-title {
        font-family: var(--font-heading);
        font-size: 2.1rem;
        color: var(--pooh-red);
        position: relative;
    }

    .story-title::after {
        content: 'üçØ';
        display: block;
        font-size: 1.5rem;
        margin-top: 4px;
        color: var(--pooh-yellow);
    }

    /* Storytelling */
    .story-section {
        margin: 16px 0;
        padding: 20px 20px 18px;
        background: rgba(255, 255, 255, 0.95);
        border-radius: 16px;
        border-left: 4px solid var(--pooh-yellow);
        position: relative;
    }

    .story-section::before {
        content: '‚Äú';
        position: absolute;
        top: -24px;
        left: 14px;
        font-size: 3.6rem;
        color: rgba(250, 204, 21, 0.4);
        font-family: 'Playfair Display', serif;
    }

    .story-text {
        font-size: 1.04rem;
        line-height: 1.8;
        color: var(--text-dark);
    }

    .woodland-sign {
        position: relative;
        background: var(--storybook-brown);
        color: white;
        padding: 11px 20px;
        border-radius: 12px;
        margin: 10px auto 16px;
        max-width: 320px;
        text-align: center;
        font-family: var(--font-heading);
        font-size: 1.35rem;
        box-shadow: 0 8px 22px rgba(55, 31, 14, 0.5);
        transform: rotate(-1deg);
        border: 3px solid rgba(250, 204, 21, 0.9);
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .woodland-sign:hover {
        transform: scale(1.05) rotate(-1deg);
        box-shadow: 0 15px 30px rgba(139, 69, 19, 0.4);
    }

    .woodland-sign::before {
        content: '';
        position: absolute;
        bottom: -22px;
        left: 50%;
        transform: translateX(-50%);
        width: 0;
        height: 0;
        border-left: 14px solid transparent;
        border-right: 14px solid transparent;
        border-top: 20px solid var(--storybook-brown);
    }

    .woodland-sign::after {
        content: '';
        position: absolute;
        bottom: -28px;
        left: 50%;
        transform: translateX(-50%);
        width: 26px;
        height: 26px;
        background: #5D4037;
        border-radius: 999px;
    }

    /* Character spotlights */
    .character-spotlight {
        display: flex;
        align-items: center;
        gap: 18px;
        margin: 18px 0;
        padding: 16px 18px;
        background: radial-gradient(circle at top left, rgba(255, 244, 214, 0.96), #ffffff 60%);
        border-radius: 18px;
        border: 1px solid rgba(148, 81, 35, 0.2);
        box-shadow: 0 8px 22px rgba(15, 23, 42, 0.12);
        transition: all 0.25s ease;
        cursor: pointer;
        position: relative;
        overflow: hidden;
    }

    .character-spotlight::before {
        content: '';
        position: absolute;
        inset: 0;
        background: radial-gradient(circle at top right, rgba(255, 223, 138, 0.2), transparent 60%);
        opacity: 0;
        transition: opacity 0.25s ease;
    }

    .character-spotlight:hover {
        transform: translateY(-3px);
        box-shadow: 0 14px 32px rgba(15, 23, 42, 0.18);
    }

    .character-spotlight:hover::before {
        opacity: 1;
    }

    .character-illustration {
        width: 105px;
        height: 105px;
        border-radius: 999px;
        overflow: hidden;
        flex-shrink: 0;
        box-shadow: 0 12px 26px rgba(0, 0, 0, 0.22);
        border: 4px solid var(--pooh-yellow);
        background: var(--page-yellow);
        display: flex;
        align-items: center;
        justify-content: center;
        transition: transform 0.25s ease;
    }

    .character-illustration img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 50%;
    }

    .character-spotlight:hover .character-illustration {
        transform: scale(1.04);
    }

    .character-spotlight-content {
        display: flex;
        flex-direction: column;
        gap: 6px;
    }

    .character-quote {
        font-family: var(--font-heading);
        font-size: 1.35rem;
        color: var(--storybook-brown);
        line-height: 1.5;
        text-shadow: 0 1px 0 rgba(255,255,255,0.7);
    }

    .character-name {
        font-family: var(--font-heading);
        font-weight: 700;
        color: var(--pooh-red);
        font-size: 1rem;
    }

    /* Invitation details & RSVP */
    .invitation-details {
        display: grid;
        grid-template-columns: repeat(2, minmax(0, 1fr));
        gap: 16px;
        margin: 22px 0 10px;
    }

    .detail-card {
        background: #FFFFFF;
        padding: 16px 16px 14px;
        border-radius: 16px;
        box-shadow: 0 6px 16px rgba(15, 23, 42, 0.12);
        border-top: 4px solid var(--pooh-yellow);
        transition: all 0.22s ease;
        position: relative;
        overflow: hidden;
    }

    .detail-card::before {
        content: '';
        position: absolute;
        inset: 0;
        background: linear-gradient(135deg, rgba(255, 249, 219, 0.8), transparent);
        opacity: 0;
        transition: opacity 0.22s ease;
    }

    .detail-card:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 22px rgba(15, 23, 42, 0.18);
    }

    .detail-card:hover::before {
        opacity: 1;
    }

    .detail-title {
        font-family: var(--font-heading);
        color: var(--pooh-red);
        font-size: 1.1rem;
        margin-bottom: 6px;
    }

    .detail-content {
        font-size: 0.96rem;
        color: var(--storybook-brown);
        line-height: 1.7;
    }

    .rsvp-form {
        background: rgba(255, 255, 255, 0.96);
        border-radius: 16px;
        padding: 18px;
        border: 1px solid rgba(148, 81, 35, 0.18);
        box-shadow: 0 12px 26px rgba(15, 23, 42, 0.12);
        margin-top: 12px;
    }

    .storybook-form {
        display: flex;
        flex-direction: column;
        gap: 14px;
    }

    .form-field {
        display: flex;
        flex-direction: column;
        gap: 6px;
    }

    .field-label {
        font-weight: 800;
        color: var(--deep-ink);
        font-size: 0.96rem;
        display: inline-flex;
        align-items: center;
        gap: 6px;
    }

    .storybook-form .form-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
        gap: 12px;
    }

    .storybook-form input,
    .storybook-form select,
    .storybook-form textarea {
        width: 100%;
        padding: 11px 13px;
        border-radius: 12px;
        border: 2px solid rgba(148, 81, 35, 0.18);
        background: #fff;
        font-family: inherit;
        font-size: 0.98rem;
        color: var(--text-dark);
        transition: border-color 0.18s ease, box-shadow 0.18s ease, background 0.18s ease;
    }

    .storybook-form input:focus,
    .storybook-form select:focus,
    .storybook-form textarea:focus {
        border-color: var(--pooh-red);
        box-shadow: 0 0 0 3px rgba(214, 46, 46, 0.18);
        outline: none;
        background: #fffdf7;
    }

    .storybook-form button {
        align-self: flex-start;
    }

    .form-status {
        margin-top: 4px;
        font-weight: 700;
        font-size: 0.95rem;
        color: var(--deep-ink);
    }

    /* Buttons */
    .magical-btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
        padding: 11px 26px;
        background: radial-gradient(circle at top, #ffe9a8 0, #f7c948 40%, #d69e2e 100%);
        color: var(--deep-ink);
        border: none;
        border-radius: 50px;
        font-family: 'Playfair Display', serif;
        font-size: 1.02rem;
        font-weight: 700;
        cursor: pointer;
        box-shadow: 0 8px 20px rgba(15, 23, 42, 0.32);
        transition: all 0.24s ease;
        text-decoration: none;
        position: relative;
        overflow: hidden;
    }

    .magical-btn::after {
        content: '';
        position: absolute;
        inset: 0;
        background: radial-gradient(circle at top left, rgba(255,255,255,0.7), transparent 55%);
        mix-blend-mode: screen;
        opacity: 0;
        transition: opacity 0.24s ease;
    }

    .magical-btn:hover {
        transform: translateY(-1px);
        box-shadow: 0 12px 26px rgba(15, 23, 42, 0.4);
    }

    .magical-btn:hover::after {
        opacity: 1;
    }

    .back-btn {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 6px;
        padding: 8px 16px;
        background: rgba(255, 255, 255, 0.9);
        color: var(--storybook-brown);
        border: 1px solid rgba(148, 81, 35, 0.3);
        border-radius: 50px;
        font-family: var(--font-body);
        font-size: 0.9rem;
        font-weight: 700;
        cursor: pointer;
        transition: all 0.24s ease;
        text-decoration: none;
        margin-top: 10px;
    }

    .back-btn:hover {
        background: rgba(255, 255, 255, 1);
        box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }

    /* Multi-game: selector + containers */
    .games-selector {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin: 24px 0;
    }

    .game-card {
        background: rgba(255, 255, 255, 0.97);
        border-radius: 20px;
        padding: 22px 20px 20px;
        text-align: center;
        border: 2px dashed rgba(250, 204, 21, 0.9);
        position: relative;
        overflow: hidden;
        box-shadow: 0 10px 28px rgba(15, 23, 42, 0.16);
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .game-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 15px 35px rgba(15, 23, 42, 0.2);
    }

    .game-card.active {
        border-color: var(--pooh-yellow);
        box-shadow: 0 0 0 3px rgba(255, 196, 43, 0.3);
    }

    .game-icon {
        width: 80px;
        height: 80px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 15px;
        font-size: 2.5rem;
        color: white;
    }

    .honey-icon {
        background: var(--pooh-yellow);
    }

    .defense-icon {
        background: var(--pooh-red);
    }

    .game-card-title {
        font-family: var(--font-heading);
        font-size: 1.8rem;
        color: var(--pooh-red);
        margin-bottom: 10px;
    }

    .game-card-description {
        font-size: 1rem;
        color: var(--storybook-brown);
        line-height: 1.6;
        margin-bottom: 15px;
    }

    .game-container {
        display: none;
        background: rgba(255, 255, 255, 0.97);
        border-radius: 20px;
        padding: 22px 20px 20px;
        margin: 24px 0;
        text-align: center;
        border: 2px dashed rgba(250, 204, 21, 0.9);
        position: relative;
        overflow: hidden;
        box-shadow: 0 10px 28px rgba(15, 23, 42, 0.16);
    }

    .game-container.active {
        display: block;
    }

    .game-header {
        text-align: center;
        margin-bottom: 18px;
        position: relative;
    }

    .game-header h1 {
        color: var(--pooh-red);
        text-shadow: 1px 2px 0 #ffccbc;
        font-size: 2rem;
        margin-bottom: 6px;
        animation: bounce 2.4s infinite;
        font-family: var(--font-heading);
        letter-spacing: 0.03em;
    }

    .game-header p {
        font-size: 0.96rem;
        color: var(--storybook-brown);
    }

    @keyframes bounce {
        0%, 100% { transform: translateY(0); }
        50% { transform: translateY(-6px); }
    }

    .game-area {
        position: relative;
        width: 100%;
        height: 400px;
        background: linear-gradient(to bottom, #a5d6a7, #81c784);
        border-radius: 16px;
        margin: 16px 0;
        overflow: hidden;
        border: 3px solid var(--storybook-brown);
        box-shadow: 0 8px 24px rgba(0,0,0,0.15);
        touch-action: none;
    }

    .game-area.hit {
        animation: hit-shake 0.35s ease;
    }

    @keyframes hit-shake {
        0% { transform: translateX(0); }
        20% { transform: translateX(-6px); }
        40% { transform: translateX(6px); }
        60% { transform: translateX(-4px); }
        80% { transform: translateX(4px); }
        100% { transform: translateX(0); }
    }

    #honeyCanvas,
    #defenseCanvas {
        display: block;
        width: 100%;
        height: 100%;
        touch-action: none;
    }

    .game-controls {
        display: flex;
        justify-content: center;
        gap: 10px;
        margin: 16px 0;
        flex-wrap: wrap;
    }

    .game-btn {
        padding: 10px 22px;
        background: linear-gradient(135deg, #ffb74d, #f57c00);
        border: none;
        border-radius: 50px;
        color: white;
        font-weight: bold;
        cursor: pointer;
        box-shadow: 0 4px 0 #e65100;
        transition: all 0.2s;
        font-size: 0.96rem;
        position: relative;
        overflow: hidden;
    }

    .game-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
        transition: left 0.5s ease;
    }

    .game-btn:hover::before {
        left: 100%;
    }

    .game-btn:hover:not(:disabled) {
        transform: translateY(-1px);
        box-shadow: 0 6px 0 #e65100;
    }

    .game-btn:active:not(:disabled) {
        transform: translateY(1px);
        box-shadow: 0 2px 0 #e65100;
    }

    .game-btn:disabled {
        background: #bdbdbd;
        box-shadow: 0 4px 0 #757575;
        cursor: not-allowed;
    }

    .mobile-controls {
        display: none;
        justify-content: center;
        margin: 16px 0;
        gap: 12px;
    }

    .mobile-control-btn {
        flex: 1;
        padding: 14px;
        max-width: 150px;
        background: linear-gradient(135deg, #ffb74d, #f57c00);
        border: none;
        border-radius: 16px;
        color: white;
        font-weight: bold;
        font-size: 1.4rem;
        box-shadow: 0 4px 0 #e65100;
        touch-action: manipulation;
        user-select: none;
    }

    .mobile-control-btn:active {
        transform: translateY(2px);
        box-shadow: 0 2px 0 #e65100;
    }

    .stats-container {
        display: grid;
        grid-template-columns: repeat(4, minmax(0, 1fr));
        gap: 10px;
        margin: 16px 0;
    }

    .stat {
        background: linear-gradient(135deg, #ffecb3 0%, #ffcc80 100%);
        padding: 10px 10px;
        border-radius: 14px;
        font-size: 1.02em;
        font-weight: bold;
        box-shadow: 0 4px 10px rgba(0,0,0,0.12);
        border: 2px solid #ffb300;
    }

    .message-box {
        background: #fff8e1;
        border: 3px dashed #ffb300;
        border-radius: 18px;
        padding: 14px 16px;
        margin: 16px 0 10px;
        min-height: 70px;
        font-size: 1.15em;
        display: flex;
        align-items: center;
        justify-content: center;
        text-align: center;
        position: relative;
        animation: pulse 2.2s infinite;
        font-family: var(--font-heading);
    }

    @keyframes pulse {
        0%, 100% { border-color: #ffb300; }
        50% { border-color: #ff9800; }
    }

    .pooh-face {
        font-size: 1.7em;
        margin-right: 8px;
    }

    .achievements {
        margin-top: 14px;
        padding: 12px 10px 8px;
        background: #ffecb3;
        border-radius: 14px;
        border: 2px solid #ffb300;
        text-align: left;
        font-size: 0.92rem;
    }

    .achievements h3 {
        margin-bottom: 4px;
        font-size: 0.98rem;
    }

    .achievement {
        display: inline-block;
        background: #ffcc80;
        padding: 6px 12px;
        margin: 3px;
        border-radius: 999px;
        font-size: 0.82em;
    }

    .hidden {
        display: none;
    }

    /* Defense-specific */
    .defender-options {
        position: absolute;
        bottom: 10px;
        left: 0;
        right: 0;
        display: flex;
        justify-content: center;
        gap: 15px;
        padding: 10px;
        z-index: 10;
    }

    .defender-option {
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 8px 12px;
        background: rgba(255, 255, 255, 0.9);
        border-radius: 12px;
        cursor: pointer;
        transition: all 0.2s ease;
        border: 2px solid transparent;
        min-width: 70px;
    }

    .defender-option.active {
        border-color: var(--pooh-yellow);
        background: rgba(255, 244, 184, 0.9);
        transform: scale(1.05);
    }

    .defender-icon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin-bottom: 5px;
        font-size: 1.2rem;
        color: white;
        overflow: hidden;
    }

    .defender-icon img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 50%;
    }

    .pooh-icon { background: var(--pooh-yellow); }
    .piglet-icon { background: #F8BBD9; }
    .tigger-icon { background: #FF8C42; }

    .defender-name {
        font-size: 0.85rem;
        font-weight: bold;
        color: var(--storybook-brown);
        margin-bottom: 3px;
    }

    .defender-cost {
        font-size: 0.75rem;
        color: var(--pooh-red);
        font-weight: bold;
    }

    /* Particles */
    .particle {
        position: absolute;
        pointer-events: none;
        z-index: 100;
    }

    /* Reading progress */
    .reading-progress {
        position: fixed;
        top: 0;
        left: 0;
        width: 0%;
        height: 4px;
        background: linear-gradient(90deg, var(--pooh-yellow), var(--pooh-red));
        z-index: 1000;
        transition: width 0.25s ease;
    }

    /* Character modal */
    .character-modal {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(15, 23, 42, 0.78);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 10000;
        opacity: 0;
        visibility: hidden;
        transition: all 0.4s ease;
    }

    .character-modal.active {
        opacity: 1;
        visibility: visible;
    }

    .modal-content {
        background: #FEF9E7;
        width: 90%;
        max-width: 620px;
        border-radius: 20px;
        padding: 24px 24px 22px;
        position: relative;
        transform: scale(0.86);
        transition: transform 0.4s ease;
        box-shadow: 0 28px 80px rgba(0,0,0,0.55);
    }

    .character-modal.active .modal-content {
        transform: scale(1);
    }

    .close-modal {
        position: absolute;
        top: 12px;
        right: 14px;
        background: none;
        border: none;
        font-size: 1.4rem;
        cursor: pointer;
        color: var(--storybook-brown);
        transition: color 0.22s ease, transform 0.18s ease;
    }

    .close-modal:hover {
        color: var(--pooh-red);
        transform: scale(1.08);
    }

    .modal-character {
        display: flex;
        align-items: center;
        gap: 16px;
        margin-bottom: 16px;
    }

    .modal-character-icon {
        width: 76px;
        height: 76px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 2rem;
        color: white;
        flex-shrink: 0;
        overflow: hidden;
    }

    .modal-character-icon img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 50%;
    }

    .modal-character-name {
        font-family: 'Playfair Display', serif;
        font-size: 1.8rem;
        color: var(--pooh-red);
    }

    .modal-character-quote {
        font-family: var(--font-heading);
        font-size: 1.6rem;
        color: var(--storybook-brown);
        margin-bottom: 14px;
        text-align: center;
    }

    .modal-character-bio {
        font-size: 0.98rem;
        color: var(--storybook-brown);
        line-height: 1.8;
    }

    .pooh-icon-modal { background: var(--pooh-yellow); }
    .piglet-icon-modal { background: #F8BBD9; }
    .tigger-icon-modal { background: #FF8C42; }
    .eeyore-icon-modal { background: #9CA3AF; }

    /* FAB & music */
    .fab-container {
        position: fixed;
        bottom: 92px;
        right: 22px;
        z-index: 1000;
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .fab {
        width: 52px;
        height: 52px;
        border-radius: 50%;
        background: radial-gradient(circle at top, #ffe9a8 0, #f7c948 40%, #d69e2e 100%);
        border: none;
        color: white;
        font-size: 1.25rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 10px 22px rgba(15, 23, 42, 0.35);
        transition: all 0.22s ease;
        position: relative;
        overflow: hidden;
    }

    .fab::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(circle at center, rgba(255,255,255,0.3) 0%, transparent 70%);
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .fab:hover::before {
        opacity: 1;
    }

    .fab:hover {
        background: radial-gradient(circle at top, #ffdba0 0, #f59e0b 40%, #c05621 100%);
        transform: translateY(-2px) scale(1.04);
    }

    .music-controls {
        position: fixed;
        bottom: 92px;
        left: 22px;
        z-index: 1000;
        display: flex;
        flex-direction: column;
        gap: 10px;
    }

    .music-btn,
    .accessibility-btn {
        width: 52px;
        height: 52px;
        border-radius: 50%;
        background: radial-gradient(circle at top, #ffe9a8 0, #f7c948 40%, #d69e2e 100%);
        border: none;
        color: white;
        font-size: 1.2rem;
        cursor: pointer;
        display: flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 10px 22px rgba(15, 23, 42, 0.35);
        transition: all 0.22s ease;
        position: relative;
        overflow: hidden;
    }

    .music-btn::before,
    .accessibility-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: radial-gradient(circle at center, rgba(255,255,255,0.3) 0%, transparent 70%);
        opacity: 0;
        transition: opacity 0.3s ease;
    }

    .music-btn:hover::before,
    .accessibility-btn:hover::before {
        opacity: 1;
    }

    .music-btn:hover,
    .accessibility-btn:hover {
        background: radial-gradient(circle at top, #ffdba0 0, #f59e0b 40%, #c05621 100%);
        transform: translateY(-2px) scale(1.04);
    }

    /* Footer */
    .footer {
        text-align: center;
        padding: 24px 10px 6px;
        margin-top: 34px;
        font-family: var(--font-heading);
        font-size: 1.35rem;
        color: var(--storybook-brown);
        border-top: 1px dashed rgba(250, 204, 21, 0.9);
    }

    .footer p:last-child {
        font-size: 1.05rem;
        margin-top: 4px;
        opacity: 0.9;
    }

    /* Responsive */
    @media (max-width: 900px) {
        .nav-toggle {
            display: flex;
        }

        .nav-menu {
            position: absolute;
            top: 60px;
            right: 14px;
            background: rgba(255, 250, 241, 0.98);
            padding: 10px;
            border-radius: 16px;
            box-shadow: 0 12px 30px rgba(15, 23, 42, 0.25);
            flex-direction: column;
            align-items: flex-start;
            display: none;
        }

        .nav-menu.open {
            display: flex;
        }

        .games-selector {
            grid-template-columns: 1fr;
        }

        .stats-container {
            grid-template-columns: repeat(2, minmax(0, 1fr));
        }

        .game-area {
            height: 320px;
        }

        .defender-options {
            gap: 8px;
        }

        .defender-option {
            min-width: 60px;
            padding: 6px 8px;
        }

        .defender-icon {
            width: 30px;
            height: 30px;
            font-size: 1rem;
        }

        .invitation-details {
            grid-template-columns: 1fr;
        }

        .mobile-controls {
            display: flex;
        }
    }

    @media (max-width: 520px) {
        .game-controls {
            flex-direction: column;
        }

        .storybook {
            padding: 26px 18px 32px;
        }

        .game-area {
            height: 260px;
        }
    }
    </style>
</head>
<body>

<a href="#mainContent" class="skip-link">Skip to main content</a>
<div class="reading-progress" id="readingProgress"></div>

<!-- Loading -->
<div class="loading-screen" id="loadingScreen" aria-hidden="true">
    <div class="honey-spinner">
        <div class="loading-jar">
            <div class="loading-honey-fill"></div>
        </div>
    </div>
    <div class="loading-text">Stirring the Honey...</div>
    <div class="loading-subtext">The Hundred Acre Wood is getting ready for Baby Gunner's celebration.</div>
    <div class="loading-dots">
        <div class="loading-dot"></div>
        <div class="loading-dot"></div>
        <div class="loading-dot"></div>
    </div>
    <div class="loading-hint">Tip: On mobile, use the big arrow buttons or tap on the left/right side of the game to move Pooh.</div>
</div>

<!-- Background layers -->
<div class="honeycomb-bg" aria-hidden="true"></div>
<div class="golden-light" aria-hidden="true"></div>

<div class="enchanted-forest" aria-hidden="true">
    <div class="tree" style="left: -40px;"></div>
    <div class="tree" style="right: -40px; height: 260px; width: 200px;"></div>
    <div class="floating-leaf" style="left: 10%; animation-delay: -4s;"></div>
    <div class="floating-leaf" style="left: 40%; animation-delay: -8s;"></div>
    <div class="floating-leaf" style="left: 70%; animation-delay: -2s;"></div>
    <div class="floating-leaf" style="left: 85%; animation-delay: -10s;"></div>
</div>

<!-- Nav -->
<nav class="main-nav" id="mainNav" aria-label="Primary">
    <div class="nav-container">
        <div class="nav-brand">
            <a href="#" class="nav-title">Hundred Acre Wood</a>
            <div class="nav-subtitle">Baby Gunner's Celebration</div>
        </div>

        <button class="nav-toggle" id="navToggle" aria-label="Toggle navigation menu">
            <i class="fas fa-bars"></i>
        </button>

        <div class="nav-menu" id="navMenu">
            <a href="#section1" class="nav-item active" data-section="section1">
                <i class="fas fa-home"></i>
                <span>Story Beginning</span>
            </a>
            <a href="#section2" class="nav-item" data-section="section2">
                <i class="fas fa-envelope"></i>
                <span>Invitation</span>
            </a>
            <a href="#section3" class="nav-item" data-section="section3">
                <i class="fas fa-users"></i>
                <span>Meet the Characters</span>
            </a>
            <a href="#section4" class="nav-item" data-section="section4">
                <i class="fas fa-gamepad"></i>
                <span>Woodland Activities</span>
            </a>
            <a href="#section5" class="nav-item" data-section="section5">
                <i class="fas fa-gift"></i>
                <span>Gunner's Treasure Trove</span>
            </a>
            <a href="#section6" class="nav-item" data-section="section6">
                <i class="fas fa-map-marker-alt"></i>
                <span>Location & Details</span>
            </a>
        </div>
    </div>
</nav>

<!-- Storybook cover -->
<div class="storybook-cover" id="storybookCover" aria-labelledby="coverTitle">
    <div class="cover-decoration"></div>
    <h1 class="cover-title" id="coverTitle">The Hundred Acre Celebration</h1>
    <p class="cover-subtitle">Welcoming Baby Gunner to Our Story</p>
    <button class="open-book-btn" id="openBookBtn">
        <i class="fas fa-book-open"></i>
        Open the Story
    </button>
</div>

<!-- Music & accessibility controls -->
<div class="music-controls">
    <button class="music-btn" id="musicToggle" aria-label="Toggle background music">
        <i class="fas fa-music"></i>
    </button>
    <button class="accessibility-btn" id="motionToggle" aria-label="Toggle reduced motion">
        <i class="fas fa-universal-access"></i>
    </button>
</div>

<!-- Background music element (replace src with your own hosted track if desired) -->
<audio id="bgMusic" loop preload="auto">
    <source src="media/hundred-acre-lullaby.mp3" type="audio/mpeg">
</audio>

<!-- FABs -->
<div class="fab-container">
    <button class="fab" id="scrollTopFab" aria-label="Back to top">
        <i class="fas fa-arrow-up"></i>
    </button>
    <button class="fab" id="scrollRsvpFab" aria-label="Jump to RSVP">
        <i class="fas fa-heart"></i>
    </button>
</div>

<!-- Main content -->
<main id="mainContent">
    <div class="storybook-shell">
        <div class="storybook" id="storybook">
            <div class="storybook-inner">
                <header class="storybook-header">
                    <h2 class="storybook-heading">Once upon a very special day...</h2>
                    <p class="storybook-subheading">A new little friend joins the Hundred Acre Wood</p>
                </header>

                <!-- Section 1 -->
                <section class="content-section scroll-animate" id="section1">
                    <div class="content-section-inner">
                        <div class="section-number">1</div>
                        <div class="section-header">
                            <h2 class="story-title">Once Upon a Time in the Hundred Acre Wood...</h2>
                        </div>

                        <div class="woodland-sign" onclick="playWoodlandSound(event)">
                            Welcome to the Hundred Acre Wood
                        </div>

                        <div class="story-section">
                            <p class="story-text">
                                In a corner of the world where stories grow on trees and adventures wait around every bend,
                                a very special celebration is being prepared. The friends of the Hundred Acre Wood are gathering
                                together, for they've heard the most wonderful news ‚Äì a new friend is coming to join their adventures:
                                Baby Gunner.
                            </p>
                        </div>

                        <div class="character-spotlight" data-character="pooh" onclick="showCharacterModal('pooh')">
                            <div class="character-illustration">
                                <img src="Images/Characters/honey-bear.png" alt="Winnie the Pooh">
                            </div>
                            <div class="character-spotlight-content">
                                <div class="character-quote">
                                    "Oh, bother! I do believe this calls for a Very Special Something. Perhaps with a little honey?"
                                </div>
                                <div class="character-name">- Winnie the Pooh</div>
                            </div>
                        </div>

                        <div class="story-section">
                            <p class="story-text">
                                And so it was decided that all the creatures of the wood would come together for a Grand Celebration
                                to welcome this new little friend. They would share stories, play games, and of course, enjoy
                                plenty of honey and treats. For when a new friend arrives in the Hundred Acre Wood, it is always
                                a cause for the happiest of gatherings.
                            </p>
                        </div>
                    </div>
                </section>

                <!-- Section 2: Invitation -->
                <section class="content-section scroll-animate" id="section2">
                    <div class="content-section-inner">
                        <div class="section-number">2</div>
                        <div class="section-header">
                            <h2 class="story-title">You Are Cordially Invited</h2>
                        </div>

                        <div class="woodland-sign" onclick="playWoodlandSound(event)">
                            Party This Way ‚Üí
                        </div>

                        <div class="story-section">
                            <p class="story-text">
                                The friends of the Hundred Acre Wood request the pleasure of your company at a Very Special
                                Celebration in honor of Baby Gunner. Come share in the joy, laughter, and honey-sweet moments
                                as we prepare to welcome this new little adventurer to our story.
                            </p>
                        </div>

                        <div class="invitation-details">
                            <div class="detail-card">
                                <div class="detail-title">Date & Time</div>
                                <div class="detail-content">
                                    Saturday, February 15, 2025<br>
                                    1:00 PM ‚Äì 4:00 PM<br>
                                    (Arrive a few minutes early to visit the honey jars and guestbook.)
                                </div>
                            </div>
                            <div class="detail-card">
                                <div class="detail-title">Location</div>
                                <div class="detail-content">
                                    The Hundred Acre Gathering Hall<br>
                                    123 Storybook Lane<br>
                                    Hometown, USA<br>
                                    <em>Follow the balloons and honey pots from the parking lot.</em>
                                </div>
                            </div>
                        </div>

                        <div class="rsvp-form" id="rsvp">
                            <h3 style="font-family: var(--font-heading); font-size: 1.4rem; margin-bottom: 8px; color: var(--storybook-brown);">
                                RSVP to Join the Celebration
                            </h3>
                            <form class="storybook-form" id="rsvpForm">
                                <div class="form-grid">
                                    <div class="form-field">
                                        <label class="field-label" for="guestName">
                                            <i class="fas fa-user"></i> Your Name
                                        </label>
                                        <input id="guestName" name="guestName" type="text" required placeholder="Who's coming from your Hundred Acre Wood?" />
                                    </div>
                                    <div class="form-field">
                                        <label class="field-label" for="guestCount">
                                            <i class="fas fa-users"></i> Number of Guests
                                        </label>
                                        <select id="guestCount" name="guestCount" required>
                                            <option value="">Select</option>
                                            <option value="1">Just me</option>
                                            <option value="2">2</option>
                                            <option value="3">3</option>
                                            <option value="4">4</option>
                                            <option value="5">5</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-field">
                                    <label class="field-label" for="guestNote">
                                        <i class="fas fa-comment-dots"></i> Notes for the Hosts
                                    </label>
                                    <textarea id="guestNote" name="guestNote" rows="3" placeholder="Share favorite snacks, allergies, or a short note for Baby Gunner."></textarea>
                                </div>
                                <button type="submit" class="magical-btn">
                                    <i class="fas fa-paper-plane"></i>
                                    Send RSVP
                                </button>
                                <div class="form-status" id="rsvpStatus" aria-live="polite"></div>
                            </form>
                        </div>
                    </div>
                </section>

                <!-- Section 3: Characters -->
                <section class="content-section scroll-animate" id="section3">
                    <div class="content-section-inner">
                        <div class="section-number">3</div>

                        <div class="section-header">
                            <h2 class="story-title">Meet Our Hosts</h2>
                        </div>

                        <div class="woodland-sign" onclick="playWoodlandSound(event)">
                            Character Meet &amp; Greet
                        </div>

                        <div class="story-section">
                            <p class="story-text">
                                All your favorite friends from the Hundred Acre Wood will be there to welcome you and share
                                in the celebration. Each has prepared a little something special for Baby Gunner (and for you).
                                Tap or click on a character to learn more about how they're helping with the party.
                            </p>
                        </div>

                        <div class="character-spotlight" onclick="showCharacterModal('pooh')">
                            <div class="character-illustration">
                                <img src="Images/Characters/honey-bear.png" alt="Winnie the Pooh">
                            </div>
                            <div class="character-spotlight-content">
                                <div class="character-quote">
                                    "Sometimes the smallest things take up the most room in your heart."
                                </div>
                                <div class="character-name">Winnie the Pooh</div>
                            </div>
                        </div>

                        <div class="character-spotlight" onclick="showCharacterModal('piglet')">
                            <div class="character-illustration">
                                <img src="Images/Characters/piglet.png" alt="Piglet">
                            </div>
                            <div class="character-spotlight-content">
                                <div class="character-quote">
                                    "Even the littlest friend can bring the greatest joy."
                                </div>
                                <div class="character-name">Piglet</div>
                            </div>
                        </div>

                        <div class="character-spotlight" onclick="showCharacterModal('tigger')">
                            <div class="character-illustration">
                                <img src="Images/Characters/tigger.png" alt="Tigger">
                            </div>
                            <div class="character-spotlight-content">
                                <div class="character-quote">
                                    "New babies are what Tiggers like best!"
                                </div>
                                <div class="character-name">Tigger</div>
                            </div>
                        </div>

                        <div class="character-spotlight" onclick="showCharacterModal('eeyore')">
                            <div class="character-illustration">
                                <img src="Images/Characters/eeyore.png" alt="Eeyore">
                            </div>
                            <div class="character-spotlight-content">
                                <div class="character-quote">
                                    "Not that I'm complaining, but it will be rather nice to have someone new around."
                                </div>
                                <div class="character-name">Eeyore</div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Section 4: Games -->
                <section class="content-section scroll-animate" id="section4">
                    <div class="content-section-inner">
                        <div class="section-number">4</div>

                        <div class="section-header">
                            <h2 class="story-title">Woodland Games &amp; Activities</h2>
                        </div>

                        <div class="woodland-sign" onclick="playWoodlandSound(event)">
                            Games &amp; Adventures
                        </div>

                        <div class="story-section">
                            <p class="story-text">
                                The Hundred Acre Wood is full of wonderful games and adventures. Whether you're helping Pooh
                                gather honey or defending the honey harvest from Heffalumps and Woozles, there's a story for
                                every guest to play. On phones and tablets, use the big arrows or tap on each side of the game area
                                for quick, thumb-friendly controls.
                            </p>
                        </div>

                        <!-- Game selector -->
                        <div class="games-selector">
                            <div class="game-card active" data-game="honey">
                                <div class="game-icon honey-icon">
                                    <i class="fas fa-jar"></i>
                                </div>
                                <h3 class="game-card-title">Honey Collector</h3>
                                <p class="game-card-description">
                                    Help Pooh collect honey pots while avoiding bees in this fast-paced adventure!
                                </p>
                                <button class="magical-btn play-game-btn" data-game="honey">
                                    <i class="fas fa-play"></i>
                                    Play Honey Collector
                                </button>
                            </div>

                            <div class="game-card" data-game="defense">
                                <div class="game-icon defense-icon">
                                    <i class="fas fa-shield-alt"></i>
                                </div>
                                <h3 class="game-card-title">Honey Harvest Defense</h3>
                                <p class="game-card-description">
                                    Defend the Hundred Acre Wood from Heffalumps and Woozles in this strategic tower defense game!
                                </p>
                                <button class="magical-btn play-game-btn" data-game="defense">
                                    <i class="fas fa-play"></i>
                                    Play Honey Defense
                                </button>
                            </div>
                        </div>

                        <!-- Honey Collector -->
                        <div class="game-container" id="honeyGame">
                            <div class="game-header">
                                <h1>Winnie the Pooh's Honey Adventure</h1>
                                <p>Help Pooh collect honey pots while avoiding bees!</p>
                            </div>

                            <div class="stats-container">
                                <div class="stat" id="honeyScore">üçØ Score: 0</div>
                                <div class="stat" id="honeyLives">‚ù§Ô∏è Lives: 3</div>
                                <div class="stat" id="honeyLevel">‚≠ê Level: 1</div>
                                <div class="stat" id="honeyTime">‚è±Ô∏è Time: 60</div>
                                <!-- New high score stat -->
                                <div class="stat" id="honeyHighScore">üèÜ Best: 0</div>
                            </div>

                            <div class="game-area" id="honeyGameArea">
                                <canvas id="honeyCanvas"></canvas>
                            </div>

                            <div class="mobile-controls">
                                <button class="mobile-control-btn" id="honeyLeftBtn">‚Üê</button>
                                <button class="mobile-control-btn" id="honeyRightBtn">‚Üí</button>
                            </div>

                            <div class="game-controls">
                                <button class="game-btn" id="honeyStartBtn">Start Game</button>
                                <button class="game-btn" id="honeyPauseBtn" disabled>Pause</button>
                                <button class="game-btn" id="honeyResetBtn">Reset</button>
                            </div>

                            <div class="message-box">
                                <span class="pooh-face">üêª</span>
                                <span id="honeyMessage">Click "Start Game" to begin. Use arrow keys, tap left/right on the game, or the big buttons on mobile.</span>
                            </div>

                            <div class="achievements">
                                <h3>Game Instructions</h3>
                                <div class="instruction">
                                    ‚Ä¢ Desktop: Use ‚Üê ‚Üí arrow keys to move Pooh<br>
                                    ‚Ä¢ Mobile: Tap the big arrows or tap on the left/right side of the game area<br>
                                    ‚Ä¢ Collect honey pots for points<br>
                                    ‚Ä¢ Avoid bees - they cost you lives!<br>
                                    ‚Ä¢ Collect glowing orbs for power-ups
                                </div>
                            </div>

                            <button class="back-btn" id="honeyBackBtn">
                                <i class="fas fa-arrow-left"></i>
                                Back to Game Selection
                            </button>
                        </div>

                        <!-- Honey Harvest Defense -->
                        <div class="game-container" id="defenseGame">
                            <div class="game-header">
                                <h1>Winnie the Pooh: Honey Harvest Defense</h1>
                                <p>Defend the Hundred Acre Wood from Heffalumps and Woozles!</p>
                            </div>

                            <div class="stats-container">
                                <div class="stat" id="defenseHoney">üçØ Honey: 100</div>
                                <div class="stat" id="defenseLives">‚ù§Ô∏è Lives: 10</div>
                                <div class="stat" id="defenseScore">‚≠ê Score: 0</div>
                                <div class="stat" id="defenseWave">üåä Wave: 1</div>
                            </div>

                            <div class="game-area">
                                <canvas id="defenseCanvas"></canvas>
                                <div class="defender-options" id="defenderOptions">
                                    <div class="defender-option active" data-type="pooh" title="Winnie the Pooh - Cost: 50">
                                        <div class="defender-icon pooh-icon">
                                            <img src="Images/Characters/honey-bear.png" alt="Pooh">
                                        </div>
                                        <div class="defender-name">Pooh</div>
                                        <div class="defender-cost">50</div>
                                    </div>
                                    <div class="defender-option" data-type="piglet" title="Piglet - Cost: 30">
                                        <div class="defender-icon piglet-icon">
                                            <img src="Images/Characters/piglet.png" alt="Piglet">
                                        </div>
                                        <div class="defender-name">Piglet</div>
                                        <div class="defender-cost">30</div>
                                    </div>
                                    <div class="defender-option" data-type="tigger" title="Tigger - Cost: 70">
                                        <div class="defender-icon tigger-icon">
                                            <img src="Images/Characters/tigger.png" alt="Tigger">
                                        </div>
                                        <div class="defender-name">Tigger</div>
                                        <div class="defender-cost">70</div>
                                    </div>
                                </div>
                            </div>

                            <div class="game-controls">
                                <button class="game-btn" id="defenseStartBtn">Start Wave</button>
                                <button class="game-btn" id="defensePauseBtn">Pause</button>
                                <button class="game-btn" id="defenseResetBtn">Reset</button>
                            </div>

                            <div class="message-box">
                                <span class="pooh-face">üêª</span>
                                <span id="defenseMessage">Select Pooh, Piglet, or Tigger and tap on the grass to place them.</span>
                            </div>

                            <div class="achievements">
                                <h3>Game Instructions</h3>
                                <div class="instruction">
                                    ‚Ä¢ Click or tap a defender (Pooh, Piglet, or Tigger) then tap on grass to place them<br>
                                    ‚Ä¢ Defenders automatically attack Heffalumps and Woozles<br>
                                    ‚Ä¢ Earn honey by defeating enemies<br>
                                    ‚Ä¢ Survive 10 waves to win!
                                </div>
                            </div>

                            <button class="back-btn" id="defenseBackBtn">
                                <i class="fas fa-arrow-left"></i>
                                Back to Game Selection
                            </button>
                        </div>
                    </div>
                </section>

                <!-- Section 5: Gifts -->
                <section class="content-section scroll-animate" id="section5">
                    <div class="content-section-inner">
                        <div class="section-number">5</div>

                        <div class="section-header">
                            <h2 class="story-title">Gunner's Treasure Trove</h2>
                        </div>

                        <div class="woodland-sign" onclick="playWoodlandSound(event)">
                            Baby's First Treasures
                        </div>

                        <div class="story-section">
                            <p class="story-text">
                                Your presence at our celebration is the greatest gift we could imagine. For those who have
                                asked about gifts, we've created a small treasure trove of items that would help welcome
                                our little one to the world. But handwritten notes, favorite children's books,
                                or simple well-wishes are equally treasured.
                            </p>
                        </div>

                        <div class="invitation-details">
                            <div class="detail-card">
                                <div class="detail-title">Book Nook</div>
                                <div class="detail-content">
                                    Bring your favorite childhood book (new or gently loved) with a note inside for Baby Gunner.
                                    The Hundred Acre Wood will become his first library.
                                </div>
                            </div>
                            <div class="detail-card">
                                <div class="detail-title">Registry</div>
                                <div class="detail-content">
                                    For anyone who asked, registry details can be shared by the hosts. Think cozy blankets,
                                    soft friends, and just enough honey-colored things to make a nursery glow.
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Section 6: Location -->
                <section class="content-section scroll-animate" id="section6">
                    <div class="content-section-inner">
                        <div class="section-number">6</div>

                        <div class="section-header">
                            <h2 class="story-title">Finding Our Woodland Gathering</h2>
                        </div>

                        <div class="woodland-sign" onclick="playWoodlandSound(event)">
                            Directions &amp; Details
                        </div>

                        <div class="story-section">
                            <p class="story-text">
                                Even the most wonderful adventures require a bit of practical planning. Here you'll find
                                all the details needed to join our celebration without any bother. From parking spots to
                                dress code (storybook-comfy), we've tucked the important notes just below.
                            </p>
                        </div>

                        <div class="invitation-details">
                            <div class="detail-card">
                                <div class="detail-title">Parking & Arrival</div>
                                <div class="detail-content">
                                    Follow the balloons and wooden signs from the main entrance. Parking attendants (disguised
                                    as friendly grown-ups) will help you find a spot.
                                </div>
                            </div>
                            <div class="detail-card">
                                <div class="detail-title">Dress Code</div>
                                <div class="detail-content">
                                    Soft, cozy, and picture-ready. Pastels, florals, or a nod to your favorite Hundred Acre
                                    friend are all welcome.
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <footer class="footer">
                    <p>"Sometimes the smallest things take up the most room in your heart."</p>
                    <p>We can't wait to celebrate Baby Gunner with you in our own little Hundred Acre Wood.</p>
                </footer>
            </div>
        </div>
    </div>
</main>

<!-- Character modal -->
<div class="character-modal" id="characterModal" role="dialog" aria-modal="true" aria-labelledby="characterModalTitle">
    <div class="modal-content">
        <button class="close-modal" id="closeCharacterModal" aria-label="Close character details">
            <i class="fas fa-times"></i>
        </button>
        <div class="modal-character">
            <div class="modal-character-icon" id="modalCharacterIcon"></div>
            <div>
                <div class="modal-character-name" id="characterModalTitle"></div>
            </div>
        </div>
        <div class="modal-character-quote" id="modalCharacterQuote"></div>
        <p class="modal-character-bio" id="modalCharacterBio"></p>
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Base elements
    const body = document.body;
    const storybookCover = document.getElementById('storybookCover');
    const openBookBtn = document.getElementById('openBookBtn');
    const storybook = document.getElementById('storybook');
    const contentSections = document.querySelectorAll('.content-section');
    const scrollAnimateElements = document.querySelectorAll('.scroll-animate');
    const navItems = document.querySelectorAll('.nav-item');
    const navMenu = document.getElementById('navMenu');
    const navToggle = document.getElementById('navToggle');
    const loadingScreen = document.getElementById('loadingScreen');
    const readingProgress = document.getElementById('readingProgress');
    const scrollTopFab = document.getElementById('scrollTopFab');
    const scrollRsvpFab = document.getElementById('scrollRsvpFab');
    const musicToggle = document.getElementById('musicToggle');
    const motionToggle = document.getElementById('motionToggle');
    const rsvpForm = document.getElementById('rsvpForm');
    const rsvpStatus = document.getElementById('rsvpStatus');
    const bgMusic = document.getElementById('bgMusic');

    // Character modal
    const characterModal = document.getElementById('characterModal');
    const closeCharacterModalBtn = document.getElementById('closeCharacterModal');
    const modalCharacterIcon = document.getElementById('modalCharacterIcon');
    const modalCharacterTitle = document.getElementById('characterModalTitle');
    const modalCharacterQuote = document.getElementById('modalCharacterQuote');
    const modalCharacterBio = document.getElementById('modalCharacterBio');

    const characterData = {
    pooh: {
        name: 'Winnie the Pooh',
        quote: '"A little Consideration, a little Thought for Others, makes all the difference."',
        image: 'Images/Characters/honey-bear.png',
        bio: 'Pooh has volunteered to be in charge of honey jars, hugs, and quiet snuggles. He is quite certain Baby Gunner will need all three in generous amounts.'
    },
    piglet: {
        name: 'Piglet',
        quote: '"It is hard to be brave, when you\'re only a Very Small Animal ‚Äî but I\'ll do it for Baby Gunner."',
        image: 'Images/Characters/piglet.png',
        bio: 'Piglet has carefully arranged the soft blankets and tiny clothes, making sure everything feels cozy, safe, and just right for someone very small.'
    },
    tigger: {
        name: 'Tigger',
        quote: '"The wonderful thing about babies is that babies are wonderful things!"',
        image: 'Images/Characters/tigger.png',
        bio: 'Tigger is in charge of games, giggles, and any moment that calls for a bounce. He\'s especially excited about showing everyone how to make Baby Gunner smile.'
    },
    eeyore: {
        name: 'Eeyore',
        quote: '"Not much of a tail, but it\'s my tail. And this is our baby, and that\'s rather special."',
        image: 'Images/Characters/eeyore.png',
        bio: 'Eeyore has quietly found the best spot for photos and moments of quiet. He is making sure there\'s always a comfortable place to sit and simply be together.'
    }
};

    // Game selection elements
    const gameCards = document.querySelectorAll('.game-card');
    const playGameButtons = document.querySelectorAll('.play-game-btn');
    const gameContainers = document.querySelectorAll('.game-container');
    const backButtons = document.querySelectorAll('.back-btn');

    let activeGame = 'honey';

    // Honey game variables
    let honeyCanvas, honeyCtx;
    let honeyGameArea = document.getElementById('honeyGameArea');
    let pooh = {
        x: 0,
        y: 0,
        width: 60,
        height: 80,
        speed: 5,
        frame: 0
    };
    let honeyPots = [];
    let bees = [];
    let powerUps = [];
    let honeyKeys = {};
    let honeyGameInterval;
    let lastHoneyTime = 0;
    let lastBeeTime = 0;
    let lastPowerUpTime = 0;
    let honeyTouchStartX = 0;
    let honeyIsMovingLeft = false;
    let honeyIsMovingRight = false;
    let particles = [];
    let honeyInitialized = false;

    let honeyGameState = {
        score: 0,
        lives: 3,
        level: 1,
        timeLeft: 60,
        isRunning: false,
        isPaused: false,
        achievements: {
            fiveHoney: false,
            tenHoney: false,
            twentyHoney: false
        }
    };

    let honeyHighScore = Number(localStorage.getItem('honeyHighScore') || 0);

    const honeyStartBtn = document.getElementById('honeyStartBtn');
    const honeyPauseBtn = document.getElementById('honeyPauseBtn');
    const honeyResetBtn = document.getElementById('honeyResetBtn');
    const honeyScoreDisplay = document.getElementById('honeyScore');
    const honeyLivesDisplay = document.getElementById('honeyLives');
    const honeyLevelDisplay = document.getElementById('honeyLevel');
    const honeyTimeDisplay = document.getElementById('honeyTime');
    const honeyHighScoreDisplay = document.getElementById('honeyHighScore');
    const honeyMessage = document.getElementById('honeyMessage');
    const honeyLeftBtn = document.getElementById('honeyLeftBtn');
    const honeyRightBtn = document.getElementById('honeyRightBtn');

    // Defense game variables
    let defenseCanvas, defenseCtx;
    let defenseInitialized = false;

    let defensePath = [
        {x: 0, y: 250},
        {x: 150, y: 250},
        {x: 150, y: 100},
        {x: 400, y: 100},
        {x: 400, y: 350},
        {x: 650, y: 350},
        {x: 650, y: 150},
        {x: 850, y: 150},
        {x: 850, y: 400},
        {x: 1000, y: 400}
    ];

    let defenseGameInterval;

    let defenseGameState = {
        honey: 100,
        lives: 10,
        score: 0,
        wave: 1,
        isRunning: false,
        isPaused: false,
        selectedDefender: 'pooh',
        defenders: [],
        enemies: [],
        projectiles: [],
        nextWaveTimer: 300
    };

    const defenseStartBtn = document.getElementById('defenseStartBtn');
    const defensePauseBtn = document.getElementById('defensePauseBtn');
    const defenseResetBtn = document.getElementById('defenseResetBtn');
    const defenseHoneyDisplay = document.getElementById('defenseHoney');
    const defenseLivesDisplay = document.getElementById('defenseLives');
    const defenseScoreDisplay = document.getElementById('defenseScore');
    const defenseWaveDisplay = document.getElementById('defenseWave');
    const defenseMessage = document.getElementById('defenseMessage');
    const defenderOptions = document.querySelectorAll('.defender-option');

    function init() {
        setupEventListeners();
        checkScrollAnimations();
        updateActiveNav();
        initReduceMotionPreference();
        initMusicPreference();

        setTimeout(() => {
            loadingScreen.classList.add('hidden');
        }, 1200);

        initHoneyGame();
        initDefenseGame();
    }

    function setupEventListeners() {
        openBookBtn.addEventListener('click', openStorybook);

        navToggle.addEventListener('click', () => {
            navMenu.classList.toggle('open');
        });

        navItems.forEach(item => {
            item.addEventListener('click', () => {
                navMenu.classList.remove('open');
            });
        });

        window.addEventListener('scroll', updateActiveNav);
        window.addEventListener('scroll', checkScrollAnimations);
        window.addEventListener('scroll', updateReadingProgress);

        scrollTopFab.addEventListener('click', () => {
            window.scrollTo({ top: 0, behavior: 'smooth' });
        });

        scrollRsvpFab.addEventListener('click', () => {
            const rsvp = document.getElementById('rsvp');
            if (rsvp) {
                rsvp.scrollIntoView({ behavior: 'smooth' });
            }
        });

        musicToggle.addEventListener('click', () => {
            if (!bgMusic) return;
            const icon = musicToggle.querySelector('i');
            // Try to play/pause; ignore play promise rejection quietly
            if (bgMusic.paused) {
                bgMusic.volume = 0.35;
                bgMusic.play().catch(() => {});
                icon.classList.remove('fa-volume-xmark');
                icon.classList.add('fa-music');
                localStorage.setItem('bg-music', 'on');
            } else {
                bgMusic.pause();
                icon.classList.remove('fa-music');
                icon.classList.add('fa-volume-xmark');
                localStorage.setItem('bg-music', 'off');
            }
        });

        motionToggle.addEventListener('click', toggleReduceMotion);

        if (rsvpForm) {
            rsvpForm.addEventListener('submit', (e) => {
                e.preventDefault();
                rsvpStatus.textContent = 'Thank you! Your RSVP has been noted.';
            });
        }

        // Game selector
        gameCards.forEach(card => {
            card.addEventListener('click', function() {
                const gameType = this.getAttribute('data-game');

                gameCards.forEach(c => c.classList.remove('active'));
                this.classList.add('active');

                activeGame = gameType;
            });
        });

        playGameButtons.forEach(button => {
            button.addEventListener('click', function() {
                const gameType = this.getAttribute('data-game');

                gameContainers.forEach(container => {
                    container.classList.remove('active');
                });

                document.getElementById(`${gameType}Game`).classList.add('active');

                if (gameType === 'honey') {
                    initHoneyGame();
                    document.getElementById('section4').scrollIntoView({ behavior: 'smooth' });
                } else if (gameType === 'defense') {
                    initDefenseGame();
                    document.getElementById('section4').scrollIntoView({ behavior: 'smooth' });
                }
            });
        });

        backButtons.forEach(button => {
            button.addEventListener('click', function() {
                gameContainers.forEach(container => {
                    container.classList.remove('active');
                });
            });
        });

        // Character modal close
        closeCharacterModalBtn.addEventListener('click', () => {
            characterModal.classList.remove('active');
        });
        characterModal.addEventListener('click', (e) => {
            if (e.target === characterModal) {
                characterModal.classList.remove('active');
            }
        });

        // Simple resize handler to keep honey canvas responsive
        window.addEventListener('resize', () => {
            if (honeyCanvas) {
                const oldWidth = honeyCanvas.width;
                honeyCanvas.width = honeyCanvas.offsetWidth;
                honeyCanvas.height = honeyCanvas.offsetHeight;
                if (oldWidth > 0) {
                    pooh.x = (pooh.x / oldWidth) * honeyCanvas.width;
                    if (pooh.x < 0) pooh.x = 0;
                    if (pooh.x > honeyCanvas.width - pooh.width) {
                        pooh.x = honeyCanvas.width - pooh.width;
                    }
                }
                renderHoneyGame();
            }
        });
    }

    function openStorybook() {
        storybookCover.classList.add('closed');

        setTimeout(() => {
            storybook.classList.add('visible');
            contentSections.forEach(section => {
                section.classList.add('visible');
            });
        }, 800);
    }

    function updateActiveNav() {
        const scrollPosition = window.pageYOffset + 110;

        navItems.forEach(item => {
            const sectionId = item.getAttribute('data-section');
            if (sectionId) {
                const section = document.getElementById(sectionId);
                if (section) {
                    const rect = section.getBoundingClientRect();
                    const sectionTop = rect.top + window.pageYOffset;
                    const sectionBottom = sectionTop + section.offsetHeight;

                    if (scrollPosition >= sectionTop && scrollPosition < sectionBottom) {
                        item.classList.add('active');
                    } else {
                        item.classList.remove('active');
                    }
                }
            }
        });
    }

    function checkScrollAnimations() {
        const windowHeight = window.innerHeight;
        const triggerBottom = windowHeight * 0.8;

        scrollAnimateElements.forEach(element => {
            const elementTop = element.getBoundingClientRect().top;
            if (elementTop < triggerBottom) {
                element.classList.add('visible');
            }
        });
    }

    function updateReadingProgress() {
        const doc = document.documentElement;
        const scrollTop = doc.scrollTop || document.body.scrollTop;
        const scrollHeight = doc.scrollHeight - doc.clientHeight;
        const progress = scrollHeight > 0 ? (scrollTop / scrollHeight) * 100 : 0;
        readingProgress.style.width = progress + '%';
    }

    // Reduced motion preference
    function initReduceMotionPreference() {
        const stored = localStorage.getItem('reduce-motion');
        if (stored === 'true') {
            body.classList.add('reduce-motion');
        }
    }

    function toggleReduceMotion() {
        const enabled = body.classList.toggle('reduce-motion');
        localStorage.setItem('reduce-motion', enabled ? 'true' : 'false');
    }

    // Background music preference
    function initMusicPreference() {
        if (!bgMusic) return;
        const stored = localStorage.getItem('bg-music');
        const icon = musicToggle.querySelector('i');
        if (stored === 'on') {
            bgMusic.volume = 0.35;
            bgMusic.play().catch(() => {});
            icon.classList.remove('fa-volume-xmark');
            icon.classList.add('fa-music');
        } else {
            // Default to off visually if user has previously turned it off
            if (stored === 'off') {
                icon.classList.remove('fa-music');
                icon.classList.add('fa-volume-xmark');
            }
        }
    }

    // Woodland sound
    window.playWoodlandSound = function(ev) {
        const e = ev || window.event;
        try {
            const audioContext = new (window.AudioContext || window.webkitAudioContext)();
            const oscillator = audioContext.createOscillator();
            const gainNode = audioContext.createGain();

            oscillator.connect(gainNode);
            gainNode.connect(audioContext.destination);

            oscillator.type = 'sine';
            oscillator.frequency.setValueAtTime(523.25, audioContext.currentTime);
            oscillator.frequency.setValueAtTime(659.25, audioContext.currentTime + 0.1);
            oscillator.frequency.setValueAtTime(783.99, audioContext.currentTime + 0.2);

            gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
            gainNode.gain.exponentialRampToValueAtTime(0.001, audioContext.currentTime + 0.8);

            oscillator.start();
            oscillator.stop(audioContext.currentTime + 0.8);
        } catch (e) {
            console.log("Web Audio API not supported");
        }

        const sign = e.target.closest('.woodland-sign');
        if (sign) {
            sign.style.transform = 'scale(1.08) rotate(-1deg)';
            setTimeout(() => {
                sign.style.transform = '';
            }, 300);
        }
    };

    // Character modal
    window.showCharacterModal = function(character) {
        const data = characterData[character];
        if (!data) return;
        
        // Set the modal content with the character image
        modalCharacterIcon.innerHTML = `<img src="${data.image}" alt="${data.name}">`;
        modalCharacterTitle.textContent = data.name;
        modalCharacterQuote.textContent = data.quote;
        modalCharacterBio.textContent = data.bio;
        characterModal.classList.add('active');
    };

    // ===========================
    // HONEY COLLECTOR GAME LOGIC
    // ===========================
    function initHoneyGame() {
        if (!honeyCanvas) {
            honeyCanvas = document.getElementById('honeyCanvas');
            if (!honeyCanvas) return;
            honeyCtx = honeyCanvas.getContext('2d');
        }

        honeyCanvas.width = honeyCanvas.offsetWidth;
        honeyCanvas.height = honeyCanvas.offsetHeight;

        pooh.x = honeyCanvas.width / 2 - pooh.width / 2;
        pooh.y = honeyCanvas.height - pooh.height - 10;

        if (!honeyInitialized) {
            honeyInitialized = true;

            honeyStartBtn.addEventListener('click', startHoneyGame);
            honeyPauseBtn.addEventListener('click', togglePauseHoneyGame);
            honeyResetBtn.addEventListener('click', resetHoneyGame);

            if (honeyLeftBtn && honeyRightBtn) {
                honeyLeftBtn.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    honeyIsMovingLeft = true;
                });
                honeyLeftBtn.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    honeyIsMovingLeft = false;
                });
                honeyRightBtn.addEventListener('touchstart', (e) => {
                    e.preventDefault();
                    honeyIsMovingRight = true;
                });
                honeyRightBtn.addEventListener('touchend', (e) => {
                    e.preventDefault();
                    honeyIsMovingRight = false;
                });

                honeyLeftBtn.addEventListener('mousedown', () => { honeyIsMovingLeft = true; });
                honeyLeftBtn.addEventListener('mouseup', () => { honeyIsMovingLeft = false; });
                honeyLeftBtn.addEventListener('mouseleave', () => { honeyIsMovingLeft = false; });

                honeyRightBtn.addEventListener('mousedown', () => { honeyIsMovingRight = true; });
                honeyRightBtn.addEventListener('mouseup', () => { honeyIsMovingRight = false; });
                honeyRightBtn.addEventListener('mouseleave', () => { honeyIsMovingRight = false; });
            }

            honeyCanvas.addEventListener('touchstart', handleHoneyTouchStart);
            honeyCanvas.addEventListener('touchmove', handleHoneyTouchMove);

            // Tap left/right side of canvas to nudge Pooh (good for phones)
            honeyCanvas.addEventListener('click', (e) => {
                if (!honeyGameState.isRunning || honeyGameState.isPaused) return;
                const rect = honeyCanvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                if (x < honeyCanvas.width / 2) {
                    pooh.x -= pooh.width * 1.2;
                } else {
                    pooh.x += pooh.width * 1.2;
                }
                if (pooh.x < 0) pooh.x = 0;
                if (pooh.x > honeyCanvas.width - pooh.width) {
                    pooh.x = honeyCanvas.width - pooh.width;
                }
            });

            document.addEventListener('keydown', handleHoneyKeyDown);
            document.addEventListener('keyup', handleHoneyKeyUp);
        }

        renderHoneyGame();
        updateHoneyDisplay();
    }

    function handleHoneyTouchStart(e) {
        if (!honeyGameState.isRunning || honeyGameState.isPaused) return;
        const touch = e.touches[0];
        honeyTouchStartX = touch.clientX;
    }

    function handleHoneyTouchMove(e) {
        if (!honeyGameState.isRunning || honeyGameState.isPaused) return;
        e.preventDefault();
        const touch = e.touches[0];
        const touchX = touch.clientX;
        const deltaX = touchX - honeyTouchStartX;

        pooh.x += deltaX * 0.5;
        if (pooh.x < 0) pooh.x = 0;
        if (pooh.x > honeyCanvas.width - pooh.width) pooh.x = honeyCanvas.width - pooh.width;

        honeyTouchStartX = touchX;
    }

    function handleHoneyKeyDown(e) {
        if (honeyGameState.isRunning && !honeyGameState.isPaused) {
            honeyKeys[e.key] = true;
        }
    }

    function handleHoneyKeyUp(e) {
        if (honeyGameState.isRunning && !honeyGameState.isPaused) {
            honeyKeys[e.key] = false;
        }
    }

    function startHoneyGame() {
        if (!honeyGameState.isRunning) {
            honeyGameState.isRunning = true;
            honeyGameState.isPaused = false;
            honeyGameState.score = 0;
            honeyGameState.lives = 3;
            honeyGameState.level = 1;
            honeyGameState.timeLeft = 60;
            honeyPots = [];
            bees = [];
            powerUps = [];
            particles = [];

            honeyStartBtn.disabled = true;
            honeyPauseBtn.disabled = false;
            honeyResetBtn.disabled = false;
            honeyMessage.textContent = "Game started! Use keys, taps, or buttons to move Pooh!";

            honeyGameInterval = setInterval(honeyGameLoop, 1000 / 60);

            const timerInterval = setInterval(() => {
                if (honeyGameState.isRunning && !honeyGameState.isPaused) {
                    honeyGameState.timeLeft--;
                    updateHoneyDisplay();
                    if (honeyGameState.timeLeft <= 0) {
                        clearInterval(timerInterval);
                        honeyGameOver();
                    }
                } else if (!honeyGameState.isRunning) {
                    clearInterval(timerInterval);
                }
            }, 1000);
        }
    }

    function togglePauseHoneyGame() {
        if (honeyGameState.isRunning) {
            honeyGameState.isPaused = !honeyGameState.isPaused;
            honeyPauseBtn.textContent = honeyGameState.isPaused ? 'Resume' : 'Pause';
            honeyMessage.textContent = honeyGameState.isPaused ? "Game paused" : "Game resumed!";
        }
    }

    function resetHoneyGame() {
        clearInterval(honeyGameInterval);
        honeyGameState.isRunning = false;
        honeyGameState.isPaused = false;

        honeyStartBtn.disabled = false;
        honeyPauseBtn.disabled = true;
        honeyResetBtn.disabled = true;
        honeyPauseBtn.textContent = 'Pause';
        honeyMessage.textContent = "Click 'Start Game' to begin. Use arrow keys, tap left/right, or use the big buttons.";

        Object.keys(honeyGameState.achievements).forEach(key => {
            honeyGameState.achievements[key] = false;
        });

        honeyGameState.score = 0;
        honeyGameState.lives = 3;
        honeyGameState.level = 1;
        honeyGameState.timeLeft = 60;
        honeyPots = [];
        bees = [];
        powerUps = [];
        particles = [];
        updateHoneyDisplay();
        renderHoneyGame();
    }

    function honeyGameLoop() {
        if (honeyGameState.isPaused) return;
        updateHoneyGame();
        renderHoneyGame();
        updateParticles();
    }

    function updateHoneyGame() {
        if (honeyKeys.ArrowLeft || honeyKeys.ArrowRight || honeyIsMovingLeft || honeyIsMovingRight) {
            pooh.frame = (pooh.frame + 0.2) % 4;
        } else {
            pooh.frame = 0;
        }

        if ((honeyKeys.ArrowLeft || honeyIsMovingLeft) && pooh.x > 0) {
            pooh.x -= pooh.speed;
        }
        if ((honeyKeys.ArrowRight || honeyIsMovingRight) && pooh.x < honeyCanvas.width - pooh.width) {
            pooh.x += pooh.speed;
        }

        const currentTime = Date.now();
        const spawnInterval = Math.max(300, 1000 - (honeyGameState.level * 100));
        const beeInterval = Math.max(400, 2000 - (honeyGameState.level * 150));

        if (currentTime - lastHoneyTime > spawnInterval) {
            spawnHoneyPot();
            lastHoneyTime = currentTime;
        }
        if (currentTime - lastBeeTime > beeInterval) {
            spawnBee();
            lastBeeTime = currentTime;
        }
        if (currentTime - lastPowerUpTime > 8000 && Math.random() < 0.15) {
            spawnPowerUp();
            lastPowerUpTime = currentTime;
        }

        for (let i = honeyPots.length - 1; i >= 0; i--) {
            honeyPots[i].y += honeyPots[i].speed;
            honeyPots[i].x += Math.sin(Date.now() / 200 + i) * 0.5;

            if (checkHoneyCollision(pooh, honeyPots[i])) {
                createHoneyParticles(honeyPots[i].x + honeyPots[i].width/2, honeyPots[i].y + honeyPots[i].height/2);
                honeyGameState.score += honeyPots[i].value;
                honeyPots.splice(i, 1);
                updateHoneyDisplay();
                checkHoneyAchievements();
                continue;
            }
            if (honeyPots[i].y > honeyCanvas.height) {
                honeyPots.splice(i, 1);
            }
        }

        for (let i = bees.length - 1; i >= 0; i--) {
            bees[i].y += bees[i].speed;
            bees[i].x += Math.sin(Date.now() / 100 + i) * 1.5;

            if (checkHoneyCollision(pooh, bees[i])) {
                createBeeParticles(bees[i].x + bees[i].width/2, bees[i].y + bees[i].height/2);
                triggerHoneyHitEffect();
                honeyGameState.lives--;
                bees.splice(i, 1);
                updateHoneyDisplay();
                if (honeyGameState.lives <= 0) {
                    honeyGameOver();
                }
                continue;
            }
            if (bees[i].y > honeyCanvas.height) {
                bees.splice(i, 1);
            }
        }

        for (let i = powerUps.length - 1; i >= 0; i--) {
            powerUps[i].y += powerUps[i].speed;
            powerUps[i].x += Math.sin(Date.now() / 150 + i) * 1;

            if (checkHoneyCollision(pooh, powerUps[i])) {
                createSparkleParticles(powerUps[i].x, powerUps[i].y);
                applyPowerUp(powerUps[i].type);
                powerUps.splice(i, 1);
                continue;
            }
            if (powerUps[i].y > honeyCanvas.height) {
                powerUps.splice(i, 1);
            }
        }

        if (honeyGameState.score >= honeyGameState.level * 5) {
            honeyGameState.level++;
            honeyMessage.textContent = `Level ${honeyGameState.level}! More honey, more bees!`;
            updateHoneyDisplay();
        }

        if (honeyGameState.score >= 20) {
            honeyWinGame();
        }
    }

    function renderHoneyGame() {
        if (!honeyCtx) return;
        honeyCtx.clearRect(0, 0, honeyCanvas.width, honeyCanvas.height);

        const gradient = honeyCtx.createLinearGradient(0, 0, 0, honeyCanvas.height);
        gradient.addColorStop(0, '#87CEEB');
        gradient.addColorStop(1, '#E0F7FA');
        honeyCtx.fillStyle = gradient;
        honeyCtx.fillRect(0, 0, honeyCanvas.width, honeyCanvas.height);

        drawClouds();

        honeyCtx.fillStyle = '#8B4513';
        honeyCtx.fillRect(0, honeyCanvas.height - 20, honeyCanvas.width, 20);

        honeyCtx.fillStyle = '#7CFC00';
        for (let i = 0; i < honeyCanvas.width; i += 5) {
            const height = 5 + Math.random() * 10;
            honeyCtx.fillRect(i, honeyCanvas.height - 20, 3, -height);
        }

        drawPooh();

        honeyPots.forEach(pot => {
            honeyCtx.fillStyle = pot.color;
            honeyCtx.fillRect(pot.x, pot.y, pot.width, pot.height);
            honeyCtx.fillStyle = '#8B4513';
            honeyCtx.fillRect(pot.x, pot.y, pot.width, 5);
            honeyCtx.fillRect(pot.x, pot.y + pot.height - 5, pot.width, 5);
            honeyCtx.fillStyle = 'rgba(255, 255, 255, 0.3)';
            honeyCtx.fillRect(pot.x + 5, pot.y + 5, 10, 15);
        });

        bees.forEach(bee => {
            honeyCtx.fillStyle = '#FACC15';
            honeyCtx.fillRect(bee.x, bee.y, bee.width, bee.height);
            honeyCtx.fillStyle = '#000';
            honeyCtx.fillRect(bee.x, bee.y, bee.width, 3);
            honeyCtx.fillRect(bee.x, bee.y + 7, bee.width, 3);

            const wingOffset = Math.sin(Date.now() / 100) * 3;
            honeyCtx.fillStyle = 'rgba(255, 255, 255, 0.7)';
            honeyCtx.beginPath();
            honeyCtx.ellipse(bee.x - 3, bee.y - 2 + wingOffset, 5, 8, 0, 0, Math.PI * 2);
            honeyCtx.fill();
            honeyCtx.beginPath();
            honeyCtx.ellipse(bee.x + bee.width + 3, bee.y - 2 - wingOffset, 5, 8, 0, 0, Math.PI * 2);
            honeyCtx.fill();
        });

        powerUps.forEach(powerUp => {
            honeyCtx.shadowColor = powerUp.color;
            honeyCtx.shadowBlur = 15;
            honeyCtx.fillStyle = powerUp.color;
            honeyCtx.beginPath();
            honeyCtx.arc(powerUp.x, powerUp.y, powerUp.size, 0, Math.PI * 2);
            honeyCtx.fill();
            honeyCtx.shadowBlur = 0;
            honeyCtx.fillStyle = '#FFF';
            honeyCtx.font = 'bold 12px Arial';
            honeyCtx.textAlign = 'center';
            honeyCtx.textBaseline = 'middle';
            honeyCtx.fillText(powerUp.symbol, powerUp.x, powerUp.y);
        });

        drawParticles();
    }

    function drawClouds() {
        honeyCtx.fillStyle = 'rgba(255, 255, 255, 0.8)';
        honeyCtx.beginPath();
        honeyCtx.arc(100, 60, 20, 0, Math.PI * 2);
        honeyCtx.arc(130, 60, 25, 0, Math.PI * 2);
        honeyCtx.arc(160, 60, 20, 0, Math.PI * 2);
        honeyCtx.fill();

        honeyCtx.beginPath();
        honeyCtx.arc(300, 40, 25, 0, Math.PI * 2);
        honeyCtx.arc(330, 40, 30, 0, Math.PI * 2);
        honeyCtx.arc(360, 40, 25, 0, Math.PI * 2);
        honeyCtx.fill();
    }

    function drawPooh() {
        honeyCtx.fillStyle = '#FFC42B';
        honeyCtx.fillRect(pooh.x, pooh.y, pooh.width, pooh.height);

        honeyCtx.fillStyle = '#D62E2E';
        honeyCtx.fillRect(pooh.x, pooh.y + pooh.height - 30, pooh.width, 30);

        honeyCtx.fillStyle = '#000';
        const blink = Math.sin(Date.now() / 1000) > 0 ? 1 : 0;
        honeyCtx.fillRect(pooh.x + 15, pooh.y + 20, 10, 10 * blink);
        honeyCtx.fillRect(pooh.x + 35, pooh.y + 20, 10, 10 * blink);

        honeyCtx.beginPath();
        honeyCtx.arc(pooh.x + 30, pooh.y + 45, 10, 0, Math.PI);
        honeyCtx.stroke();

        honeyCtx.fillStyle = '#FFC42B';
        const armSwing = Math.sin(Date.now() / 200) * 5;
        honeyCtx.fillRect(pooh.x - 5, pooh.y + 30, 5, 20 + armSwing);
        honeyCtx.fillRect(pooh.x + pooh.width, pooh.y + 30, 5, 20 - armSwing);
    }

    function drawParticles() {
        particles.forEach(particle => {
            honeyCtx.globalAlpha = particle.opacity;
            honeyCtx.fillStyle = particle.color;
            if (particle.type === 'sparkle') {
                honeyCtx.beginPath();
                honeyCtx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                honeyCtx.fill();
            } else if (particle.type === 'honey') {
                honeyCtx.fillRect(particle.x, particle.y, particle.size, particle.size);
            }
            honeyCtx.globalAlpha = 1;
        });
    }

    function updateParticles() {
        for (let i = particles.length - 1; i >= 0; i--) {
            particles[i].x += particles[i].vx;
            particles[i].y += particles[i].vy;
            particles[i].opacity -= 0.02;
            if (particles[i].opacity <= 0) {
                particles.splice(i, 1);
            }
        }
    }

    function createHoneyParticles(x, y) {
        for (let i = 0; i < 10; i++) {
            particles.push({
                x: x,
                y: y,
                vx: (Math.random() - 0.5) * 4,
                vy: (Math.random() - 0.5) * 4,
                size: Math.random() * 3 + 2,
                color: '#FFD700',
                opacity: 1,
                type: 'honey'
            });
        }
    }

    function createBeeParticles(x, y) {
        for (let i = 0; i < 8; i++) {
            particles.push({
                x: x,
                y: y,
                vx: (Math.random() - 0.5) * 3,
                vy: (Math.random() - 0.5) * 3,
                size: Math.random() * 2 + 1,
                color: '#000000',
                opacity: 1,
                type: 'sparkle'
            });
        }
    }

    function createSparkleParticles(x, y) {
        for (let i = 0; i < 15; i++) {
            particles.push({
                x: x,
                y: y,
                vx: (Math.random() - 0.5) * 5,
                vy: (Math.random() - 0.5) * 5,
                size: Math.random() * 4 + 2,
                color: '#FFFFFF',
                opacity: 1,
                type: 'sparkle'
            });
        }
    }

    function spawnHoneyPot() {
        const x = Math.random() * (honeyCanvas.width - 30);
        const value = Math.random() < 0.15 ? 5 : 1;
        honeyPots.push({
            x: x,
            y: 0,
            width: 30,
            height: 40,
            speed: 2 + (honeyGameState.level * 0.5),
            value: value,
            color: value === 5 ? '#FFD700' : '#E6B86A'
        });
    }

    function spawnBee() {
        const x = Math.random() * (honeyCanvas.width - 20);
        bees.push({
            x: x,
            y: 0,
            width: 20,
            height: 15,
            speed: 3 + (honeyGameState.level * 0.7)
        });
    }

    function spawnPowerUp() {
        const x = Math.random() * (honeyCanvas.width - 20);
        const types = [
            { type: 'speed', symbol: '‚ö°', color: '#FF6B6B' },
            { type: 'shield', symbol: 'üõ°Ô∏è', color: '#4ECDC4' },
            { type: 'multiplier', symbol: '‚≠ê', color: '#FFE66D' }
        ];
        const powerUp = types[Math.floor(Math.random() * types.length)];
        powerUps.push({
            x: x,
            y: 0,
            size: 15,
            speed: 2,
            ...powerUp
        });
    }

    function applyPowerUp(type) {
        switch(type) {
            case 'speed':
                pooh.speed += 2;
                honeyMessage.textContent = "Speed boost! Pooh moves faster for 5 seconds!";
                setTimeout(() => { pooh.speed -= 2; }, 5000);
                break;
            case 'shield':
                honeyGameState.lives += 1;
                honeyMessage.textContent = "Shield collected! Extra life gained!";
                break;
            case 'multiplier':
                honeyGameState.score += 5;
                honeyMessage.textContent = "Multiplier! +5 points!";
                break;
        }
        updateHoneyDisplay();
    }

    function checkHoneyCollision(obj1, obj2) {
        return obj1.x < obj2.x + obj2.width &&
               obj1.x + obj1.width > obj2.x &&
               obj1.y < obj2.y + obj2.height &&
               obj1.y + obj1.height > obj2.y;
    }

    function updateHoneyDisplay() {
        honeyScoreDisplay.textContent = `üçØ Score: ${honeyGameState.score}`;
        honeyLivesDisplay.textContent = `‚ù§Ô∏è Lives: ${honeyGameState.lives}`;
        honeyLevelDisplay.textContent = `‚≠ê Level: ${honeyGameState.level}`;
        honeyTimeDisplay.textContent = `‚è±Ô∏è Time: ${honeyGameState.timeLeft}`;
        if (honeyHighScoreDisplay) {
            honeyHighScoreDisplay.textContent = `üèÜ Best: ${honeyHighScore}`;
        }
    }

    function checkHoneyAchievements() {
        if (honeyGameState.score >= 5 && !honeyGameState.achievements.fiveHoney) {
            honeyGameState.achievements.fiveHoney = true;
            honeyMessage.textContent = "Achievement unlocked: 5 Honey Pots!";
        }
        if (honeyGameState.score >= 10 && !honeyGameState.achievements.tenHoney) {
            honeyGameState.achievements.tenHoney = true;
            honeyMessage.textContent = "Achievement unlocked: 10 Honey Pots!";
        }
        if (honeyGameState.score >= 20 && !honeyGameState.achievements.twentyHoney) {
            honeyGameState.achievements.twentyHoney = true;
        }
    }

    function triggerHoneyHitEffect() {
        if (!honeyGameArea) return;
        honeyGameArea.classList.remove('hit');
        void honeyGameArea.offsetWidth; // force reflow
        honeyGameArea.classList.add('hit');
    }

    function honeyGameOver() {
        clearInterval(honeyGameInterval);
        honeyGameState.isRunning = false;

        if (honeyGameState.score > honeyHighScore) {
            honeyHighScore = honeyGameState.score;
            localStorage.setItem('honeyHighScore', honeyHighScore);
        }

        honeyMessage.textContent = "Game Over! Pooh got stung too many times, but you can try again.";
        honeyStartBtn.disabled = false;
        honeyPauseBtn.disabled = true;
        updateHoneyDisplay();
    }

    function honeyWinGame() {
        clearInterval(honeyGameInterval);
        honeyGameState.isRunning = false;

        if (honeyGameState.score > honeyHighScore) {
            honeyHighScore = honeyGameState.score;
            localStorage.setItem('honeyHighScore', honeyHighScore);
        }

        honeyMessage.textContent = "Congratulations! You collected 20 honey pots! Pooh is very happy!";
        honeyStartBtn.disabled = false;
        honeyPauseBtn.disabled = true;
        updateHoneyDisplay();
    }

    // ==============================
    // HONEY HARVEST DEFENSE GAME
    // ==============================
    function initDefenseGame() {
        if (!defenseCanvas) {
            defenseCanvas = document.getElementById('defenseCanvas');
            if (!defenseCanvas) return;
            defenseCtx = defenseCanvas.getContext('2d');
        }

        defenseCanvas.width = defenseCanvas.offsetWidth;
        defenseCanvas.height = defenseCanvas.offsetHeight;

        if (!defenseInitialized) {
            defenseInitialized = true;

            defenseStartBtn.addEventListener('click', startDefenseWave);
            defensePauseBtn.addEventListener('click', togglePauseDefenseGame);
            defenseResetBtn.addEventListener('click', resetDefenseGame);

            defenderOptions.forEach(option => {
                option.addEventListener('click', () => {
                    defenderOptions.forEach(opt => opt.classList.remove('active'));
                    option.classList.add('active');
                    defenseGameState.selectedDefender = option.getAttribute('data-type');
                });
            });

            defenseCanvas.addEventListener('click', (e) => {
                if (!defenseGameState.isRunning || defenseGameState.isPaused) return;
                const rect = defenseCanvas.getBoundingClientRect();
                const x = e.clientX - rect.left;
                const y = e.clientY - rect.top;
                placeDefender(x, y);
            });
        }

        renderDefenseGame();
        updateDefenseDisplay();
    }

    function startDefenseWave() {
        if (!defenseGameState.isRunning) {
            defenseGameState.isRunning = true;
            defenseGameState.isPaused = false;

            defenseStartBtn.disabled = true;
            defensePauseBtn.disabled = false;
            defenseResetBtn.disabled = false;
            defenseMessage.textContent = "Wave " + defenseGameState.wave + " started! Place defenders on the grass!";

            defenseGameInterval = setInterval(defenseGameLoop, 1000 / 60);
            setTimeout(spawnDefenseEnemy, 1000);
        }
    }

    function togglePauseDefenseGame() {
        if (defenseGameState.isRunning) {
            defenseGameState.isPaused = !defenseGameState.isPaused;
            defensePauseBtn.textContent = defenseGameState.isPaused ? 'Resume' : 'Pause';
            defenseMessage.textContent = defenseGameState.isPaused ? "Game paused" : "Game resumed!";
        }
    }

    function resetDefenseGame() {
        clearInterval(defenseGameInterval);
        defenseGameState = {
            honey: 100,
            lives: 10,
            score: 0,
            wave: 1,
            isRunning: false,
            isPaused: false,
            selectedDefender: 'pooh',
            defenders: [],
            enemies: [],
            projectiles: [],
            nextWaveTimer: 300
        };

        defenseStartBtn.disabled = false;
        defensePauseBtn.disabled = true;
        defenseResetBtn.disabled = true;
        defensePauseBtn.textContent = 'Pause';
        defenseMessage.textContent = "Select Pooh, Piglet, or Tigger and place them on the grass to defend!";

        updateDefenseDisplay();
        renderDefenseGame();
    }

    function defenseGameLoop() {
        if (defenseGameState.isPaused) return;
        updateDefenseGame();
        renderDefenseGame();
    }

    function updateDefenseGame() {
        for (let i = defenseGameState.enemies.length - 1; i >= 0; i--) {
            const enemy = defenseGameState.enemies[i];
            enemy.update();

            if (enemy.pathIndex >= defensePath.length - 1) {
                defenseGameState.lives--;
                defenseGameState.enemies.splice(i, 1);
                updateDefenseDisplay();
                if (defenseGameState.lives <= 0) {
                    defenseGameOver();
                }
                continue;
            }
            if (enemy.health <= 0) {
                defenseGameState.honey += enemy.value;
                defenseGameState.score += enemy.value;
                defenseGameState.enemies.splice(i, 1);
                updateDefenseDisplay();
            }
        }

        defenseGameState.defenders.forEach(defender => {
            const target = defender.update(defenseGameState.enemies);
            if (target) {
                defenseGameState.projectiles.push(new Projectile(defender.x, defender.y, target, defender.damage));
            }
        }

        for (let i = defenseGameState.projectiles.length - 1; i >= 0; i--) {
            if (defenseGameState.projectiles[i].update()) {
                defenseGameState.projectiles.splice(i, 1);
            }
        }

        if (defenseGameState.isRunning && Math.random() < 0.02 && defenseGameState.enemies.length < 5 + defenseGameState.wave) {
            spawnDefenseEnemy();
        }

        if (defenseGameState.enemies.length === 0 && defenseGameState.isRunning) {
            defenseGameState.nextWaveTimer--;
            if (defenseGameState.nextWaveTimer <= 0) {
                defenseGameState.wave++;
                defenseGameState.nextWaveTimer = 300;
                defenseMessage.textContent = "Wave " + defenseGameState.wave + " starting!";
                updateDefenseDisplay();
            }
        }

        if (defenseGameState.wave > 10) {
            defenseWinGame();
        }
    }

    function renderDefenseGame() {
        if (!defenseCtx) return;
        defenseCtx.clearRect(0, 0, defenseCanvas.width, defenseCanvas.height);
        defenseCtx.fillStyle = '#a5d6a7';
        defenseCtx.fillRect(0, 0, defenseCanvas.width, defenseCanvas.height);
        drawDefensePath();
        defenseGameState.defenders.forEach(defender => defender.draw(defenseCtx));
        defenseGameState.enemies.forEach(enemy => enemy.draw(defenseCtx));
        defenseGameState.projectiles.forEach(projectile => projectile.draw(defenseCtx));
        if (defenseGameState.enemies.length === 0 && defenseGameState.isRunning) {
            defenseCtx.fillStyle = 'rgba(0, 0, 0, 0.7)';
            defenseCtx.font = '20px Arial';
            defenseCtx.fillText(`Next wave in: ${Math.ceil(defenseGameState.nextWaveTimer / 60)}`, 10, 30);
        }
    }

    function drawDefensePath() {
        defenseCtx.strokeStyle = '#8B4513';
        defenseCtx.lineWidth = 40;
        defenseCtx.lineCap = 'round';
        defenseCtx.lineJoin = 'round';
        defenseCtx.beginPath();
        defenseCtx.moveTo(defensePath[0].x, defensePath[0].y);
        for (let i = 1; i < defensePath.length; i++) {
            defenseCtx.lineTo(defensePath[i].x, defensePath[i].y);
        }
        defenseCtx.stroke();
    }

    function placeDefender(x, y) {
        let validPosition = true;
        for (let i = 0; i < defensePath.length - 1; i++) {
            const p1 = defensePath[i];
            const distance = Math.sqrt((x - p1.x) ** 2 + (y - p1.y) ** 2);
            if (distance < 60) {
                validPosition = false;
                break;
            }
        }

        if (!validPosition) {
            defenseMessage.textContent = "Can't place defenders on the path!";
            return;
        }

        let cost = 0;
        if (defenseGameState.selectedDefender === 'pooh') cost = 50;
        else if (defenseGameState.selectedDefender === 'piglet') cost = 30;
        else if (defenseGameState.selectedDefender === 'tigger') cost = 70;

        if (defenseGameState.honey < cost) {
            defenseMessage.textContent = "Not enough honey! Defeat enemies to earn more.";
            return;
        }

        defenseGameState.honey -= cost;
        defenseGameState.defenders.push(new Defender(x, y, defenseGameState.selectedDefender));
        updateDefenseDisplay();
        defenseMessage.textContent = "Defender placed!";
    }

    function spawnDefenseEnemy() {
        const enemyType = Math.random() < 0.3 ? 'heffalump' : 'woozle';
        defenseGameState.enemies.push(new Enemy(enemyType));
    }

    function updateDefenseDisplay() {
        defenseHoneyDisplay.textContent = `üçØ Honey: ${defenseGameState.honey}`;
        defenseLivesDisplay.textContent = `‚ù§Ô∏è Lives: ${defenseGameState.lives}`;
        defenseScoreDisplay.textContent = `‚≠ê Score: ${defenseGameState.score}`;
        defenseWaveDisplay.textContent = `üåä Wave: ${defenseGameState.wave}`;
    }

    function defenseGameOver() {
        clearInterval(defenseGameInterval);
        defenseGameState.isRunning = false;
        defenseMessage.textContent = "Game Over! The Hundred Acre Wood has been overrun!";
        defenseStartBtn.disabled = false;
        defensePauseBtn.disabled = true;
    }

    function defenseWinGame() {
        clearInterval(defenseGameInterval);
        defenseGameState.isRunning = false;
        defenseMessage.textContent = "Congratulations! You defended the Hundred Acre Wood!";
        defenseStartBtn.disabled = false;
        defensePauseBtn.disabled = true;
    }

    class Defender {
        constructor(x, y, type) {
            this.x = x;
            this.y = y;
            this.type = type;
            this.range = 150;
            this.cooldown = 0;
            this.cooldownMax = 60;

            if (type === 'pooh') {
                this.damage = 20;
                this.cooldownMax = 60;
            } else if (type === 'piglet') {
                this.damage = 10;
                this.cooldownMax = 30;
            } else if (type === 'tigger') {
                this.damage = 30;
                this.cooldownMax = 90;
            }
        }

        update(enemies) {
            if (this.cooldown > 0) {
                this.cooldown--;
                return null;
            }

            let closest = null;
            let closestDistance = this.range;
            for (const enemy of enemies) {
                const dx = enemy.x - this.x;
                const dy = enemy.y - this.y;
                const distance = Math.sqrt(dx * dx + dy * dy);
                if (distance < closestDistance) {
                    closest = enemy;
                    closestDistance = distance;
                }
            }

            if (closest) {
                this.cooldown = this.cooldownMax;
                return closest;
            }
            return null;
        }

        draw(ctx) {
            if (this.type === 'pooh') {
                ctx.fillStyle = '#FFC42B';
                ctx.fillRect(this.x - 20, this.y - 20, 40, 40);
                ctx.fillStyle = '#000';
                ctx.fillRect(this.x - 10, this.y - 10, 5, 5);
                ctx.fillRect(this.x + 5, this.y - 10, 5, 5);
                ctx.fillRect(this.x - 5, this.y + 5, 10, 3);
            } else if (this.type === 'piglet') {
                ctx.fillStyle = '#F8BBD9';
                ctx.fillRect(this.x - 15, this.y - 15, 30, 30);
                ctx.fillStyle = '#000';
                ctx.fillRect(this.x - 5, this.y - 5, 3, 3);
                ctx.fillRect(this.x + 2, this.y - 5, 3, 3);
                ctx.fillRect(this.x - 3, this.y + 3, 6, 2);
            } else if (this.type === 'tigger') {
                ctx.fillStyle = '#FF8C42';
                ctx.fillRect(this.x - 25, this.y - 25, 50, 50);
                ctx.fillStyle = '#000';
                ctx.fillRect(this.x - 20, this.y - 15, 40, 5);
                ctx.fillRect(this.x - 15, this.y, 30, 5);
                ctx.fillRect(this.x - 20, this.y + 15, 40, 5);
            }

            if (defenseGameState.selectedDefender === this.type) {
                ctx.strokeStyle = 'rgba(255, 255, 255, 0.3)';
                ctx.beginPath();
                ctx.arc(this.x, this.y, this.range, 0, Math.PI * 2);
                ctx.stroke();
            }
        }
    }

    class Enemy {
        constructor(type) {
            this.type = type;
            this.pathIndex = 0;
            this.x = defensePath[0].x;
            this.y = defensePath[0].y;
            this.speed = 1;
            this.health = 100;
            this.maxHealth = 100;
            if (type === 'heffalump') {
                this.speed = 0.7;
                this.health = 150;
                this.maxHealth = 150;
                this.value = 20;
            } else if (type === 'woozle') {
                this.speed = 1.5;
                this.health = 70;
                this.maxHealth = 70;
                this.value = 15;
            }
        }

        update() {
            if (this.pathIndex >= defensePath.length - 1) return;
            const target = defensePath[this.pathIndex + 1];
            const dx = target.x - this.x;
            const dy = target.y - this.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            if (distance < this.speed) {
                this.pathIndex++;
            } else {
                this.x += (dx / distance) * this.speed;
                this.y += (dy / distance) * this.speed;
            }
        }

        draw(ctx) {
            if (this.type === 'heffalump') {
                ctx.fillStyle = '#8B4513';
                ctx.fillRect(this.x - 20, this.y - 20, 40, 40);
                ctx.fillRect(this.x - 5, this.y - 30, 10, 20);
            } else if (this.type === 'woozle') {
                ctx.fillStyle = '#4A235A';
                ctx.fillRect(this.x - 15, this.y - 15, 30, 30);
                ctx.fillRect(this.x - 20, this.y - 25, 10, 15);
                ctx.fillRect(this.x + 10, this.y - 25, 10, 15);
            }

            const barWidth = 40;
            const barHeight = 5;
            const healthPercent = this.health / this.maxHealth;
            ctx.fillStyle = '#FF0000';
            ctx.fillRect(this.x - barWidth/2, this.y - 30, barWidth, barHeight);
            ctx.fillStyle = '#00FF00';
            ctx.fillRect(this.x - barWidth/2, this.y - 30, barWidth * healthPercent, barHeight);
        }
    }

    class Projectile {
        constructor(x, y, target, damage) {
            this.x = x;
            this.y = y;
            this.target = target;
            this.speed = 5;
            this.damage = damage;
            this.radius = 5;
        }

        update() {
            const dx = this.target.x - this.x;
            const dy = this.target.y - this.y;
            const distance = Math.sqrt(dx * dx + dy * dy);
            if (distance < this.speed) {
                this.target.health -= this.damage;
                return true;
            } else {
                this.x += (dx / distance) * this.speed;
                this.y += (dy / distance) * this.speed;
                return false;
            }
        }

        draw(ctx) {
            ctx.fillStyle = '#FFFF00';
            ctx.beginPath();
            ctx.arc(this.x, this.y, this.radius, 0, Math.PI * 2);
            ctx.fill();
        }
    }

    init();
});
</script>

</body>
</html>
